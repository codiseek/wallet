{% load static %}
{% load i18n %}
<div class="mobile-tab" id="tab-stats">
    <div class="mobile-section">
        <div class="mobile-content">


     <!-- Обновленный блок "Резерв и сбережения" с новым дизайном -->
<div class="card-gradient rounded-2xl -mt-3 mb-4">
    <h2 class="text-lg font-bold mb-6 flex items-center">
        <i class="fas fa-piggy-bank text-blue-400 mr-2"></i>
        {% trans "Мои сбережения" %}
    </h2>
    
    <!-- Уведомление о выключенном резерве -->
    <div id="reserveNotification" class="mb-2 {% if reserve_percentage != 0 %}hidden{% endif %}">
    <div class="relative mt-4 mb-4">
    <!-- Стрелка-указатель -->
    <div class="absolute -top-4 left-1/2 transform -translate-x-1/2">
        <div class="w-6 h-6 bg-blue-500 rounded-full flex items-center justify-center">
            <i class="fa-solid fa-skull text-white text-xs"></i>
        </div>
    </div>
    
    <!-- Текст в стиле мысли/комментария -->
    <div class="bg-gradient-to-r from-red-500/10 to-red-500/10 rounded-2xl p-6 border-2 border-dashed border-red-400/30">
        <p class="text-gray-200 text-sm leading-relaxed text-center">
            {% trans "Функция автоматического резерва отключена. Включите ее в панели управления, 
                    чтобы откладывать процент от доходов автоматически." %}

        </p>
    </div>
</div>

    </div>
    
    <div class="space-y-4">
       <!-- Текущий резерв -->
<div class="bg-gradient-to-r from-blue-900/30 to-purple-900/30 rounded-xl p-4 border border-blue-800/30">
    <div class="flex justify-between items-center">
        <div>
            <p class="text-sm text-gray-300">{% trans "Текущий резерв" %}</p>
            <p class="text-2xl font-bold text-blue-400 mt-1">
                <span id="currentReserveAmount" data-raw-value="{{ current_reserve|floatformat:0 }}">{{ current_reserve|floatformat:0 }}</span>
            </p>
        </div>
        <div class="text-right">
            <p class="text-sm text-gray-300">{% trans "Процент от доходов" %}</p>
            <p class="text-lg font-bold text-green-400 mt-1">
                <span id="reservePercentageDisplay">{{ reserve_percentage }}</span>%
            </p>
        </div>
    </div>
</div>

           <!-- ОБНОВЛЕННЫЙ БЛОК ЦЕЛЕВОГО РЕЗЕРВА -->
<div class="bg-gradient-to-br from-purple-500/10 to-pink-500/10 rounded-xl p-4 border border-purple-500/20">
    <div class="flex items-center justify-between mb-4">
        <div class="flex items-center space-x-2">
            <div class="w-8 h-8 rounded-lg bg-purple-500/20 flex items-center justify-center">
                <i class="fas fa-bullseye text-purple-400"></i>
            </div>
            <div>
                <p class="text-sm font-semibold text-purple-400">{% trans "Целевой резерв" %}</p>
                <p class="text-xs text-gray-400">{% trans "Ваша финансовая цель" %}</p>
            </div>
        </div>
        <div class="text-right">
            <p class="text-lg font-bold text-purple-400">
                <span id="targetReserveAmount" data-raw-value="{{ target_reserve|floatformat:0 }}">{{ target_reserve|floatformat:0 }}</span>
            </p>
        </div>
    </div>
    
    <!-- Интерактивный прогресс -->
    <div class="space-y-3">
        <div class="flex justify-between items-center">
            <span class="text-xs text-gray-400">{% trans "Прогресс" %}</span>
            <span class="text-xs font-bold text-yellow-400" id="remainingToTargetText">
                Осталось: <span id="remainingToTarget" data-raw-value="{{ remaining_to_target|floatformat:0 }}">{{ remaining_to_target|floatformat:0 }}</span>
            </span>
        </div>
        
        <!-- Основной прогресс-бар -->
        <div class="w-full bg-gray-700 rounded-full h-3 relative overflow-hidden">
            <div id="targetProgressBar" class="bg-gradient-to-r from-purple-500 to-pink-500 h-3 rounded-full transition-all duration-1000 relative" 
                 style="width: {{ progress_percentage }}%">
                <!-- Анимация "сияния" на прогресс-баре -->
                <div class="absolute inset-0 bg-gradient-to-r from-transparent via-white/30 to-transparent animate-pulse-slow"></div>
            </div>
        </div>
        
        <!-- Дополнительная информация о прогрессе -->
        <div class="grid grid-cols-3 gap-2 text-center">
            <div class="text-xs text-gray-400">
                <div class="font-bold text-blue-400" id="targetCurrentReserve" data-raw-value="{{ current_reserve|floatformat:0 }}">{{ current_reserve|floatformat:0 }}</div>
                <div>{% trans "Накоплено" %}</div>
            </div>
            <div class="text-xs text-gray-400">
                <div class="font-bold text-yellow-400" id="targetRemaining" data-raw-value="{{ remaining_to_target|floatformat:0 }}">{{ remaining_to_target|floatformat:0 }}</div>
                <div>{% trans "Осталось" %}</div>
            </div>
            <div class="text-xs text-gray-400">
                <div class="font-bold text-green-400" id="targetProgressPercent">{{ progress_percentage|floatformat:1 }}%</div>
                <div>{% trans "Выполнено" %}</div>
            </div>
        </div>
    </div>
    
    <!-- Мотивационное сообщение -->
    <div class="mt-3 text-center" id="motivationMessage">
        {% if progress_percentage == 100 %}
        <div class="bg-gradient-to-r from-green-500/20 to-emerald-500/20 rounded-lg p-2 border border-green-500/30">
            <p class="text-xs text-green-400 font-semibold">
                <i class="fas fa-trophy mr-1"></i>{% trans "Поздравляем! Цель достигнута!" %}
            </p>
        </div>
        {% elif progress_percentage > 75 %}
        <p class="text-xs text-yellow-400 animate-pulse">
            <i class="fas fa-fire mr-1"></i>{% trans "Осталось совсем немного!" %}
        </p>
        {% elif progress_percentage > 50 %}
        <p class="text-xs text-blue-400">
            <i class="fas fa-rocket mr-1"></i>{% trans "Отличный прогресс!" %}
        </p>
        {% elif progress_percentage > 25 %}
        <p class="text-xs text-purple-400">
            <i class="fas fa-seedling mr-1"></i>{% trans "Продолжайте в том же духе!" %}
        </p>
        {% else %}
        <p class="text-xs text-gray-400">
            <i class="fas fa-flag mr-1"></i>{% trans "Начните свой путь к цели" %}
        </p>
        {% endif %}
    </div>
</div>

       <!-- ОБНОВЛЕННАЯ СТАТИСТИКА РЕЗЕРВА -->
<div class="grid grid-cols-2 gap-3">
    <!-- Отложено в этом месяце - новый дизайн -->
    <div class="bg-gradient-to-br from-blue-500/10 to-blue-600/10 rounded-xl p-4 border border-blue-500/20 hover:border-blue-400/40 transition-all duration-300 group">
        <div class="flex items-center justify-between mb-2">
            <div class="w-8 h-8 rounded-lg bg-blue-500/20 flex items-center justify-center group-hover:scale-110 transition-transform">
                <i class="fas fa-calendar-plus text-blue-400 text-sm"></i>
            </div>
            <div class="text-right">
                <div class="w-3 h-3 rounded-full bg-blue-400 animate-pulse"></div>
            </div>
        </div>
        <p class="text-xs text-gray-400 mb-1">{% trans "Отложено в этом месяце" %}</p>
        <p class="text-xl font-bold text-blue-400 group-hover:text-blue-300 transition-colors">
            +<span id="monthlyReserveAmount" data-raw-value="{{ monthly_reserve|floatformat:0 }}">{{ monthly_reserve|floatformat:0 }}</span>
        </p>
        <div class="mt-2 w-full bg-blue-500/20 rounded-full h-1">
            <div class="bg-blue-400 h-1 rounded-full transition-all duration-500" style="width: {% widthratio monthly_reserve current_reserve 100 %}%"></div>
        </div>
    </div>
    
    <!-- Всего накоплено - новый дизайн -->
    <div class="bg-gradient-to-br from-green-500/10 to-green-600/10 rounded-xl p-4 border border-green-500/20 hover:border-green-400/40 transition-all duration-300 group">
        <div class="flex items-center justify-between mb-2">
            <div class="w-8 h-8 rounded-lg bg-green-500/20 flex items-center justify-center group-hover:scale-110 transition-transform">
                <i class="fas fa-chart-line text-green-400 text-sm"></i>
            </div>
            <div class="text-right">
                <i class="fas fa-trophy text-green-400 text-sm"></i>
            </div>
        </div>
        <p class="text-xs text-gray-400 mb-1">{% trans "Всего накоплено" %}</p>
        <p class="text-xl font-bold text-green-400 group-hover:text-green-300 transition-colors">
            <span id="totalReserveAmount" data-raw-value="{{ current_reserve|floatformat:0 }}">{{ current_reserve|floatformat:0 }}</span>
        </p>
        <div class="mt-2 flex items-center space-x-1">
            <div class="text-xs text-green-400">
                <i class="fas fa-arrow-up"></i>
            </div>
            <div class="text-xs text-gray-400">{% trans "растет каждый месяц" %}</div>
        </div>
    </div>
</div>

 
    </div>
</div>
            <!-- Анализ расходов по категориям -->
          
         <!-- 
<div class="card-gradient rounded-2xl p-4 mb-4">
    <h2 class="text-lg font-bold mb-4 flex items-center">
        <i class="fas fa-chart-pie text-purple-400 mr-2"></i>
        Анализ расходов
    </h2> 
    
    <div class="space-y-4">
        
        <div class="flex items-center justify-center py-4">
            <div class="relative w-40 h-40">
                
                <div class="absolute inset-0 flex items-center justify-center">
                    <div class="text-center">
                        <div class="text-2xl font-bold text-white" id="expensePercentage">0%</div>
                        <div class="text-xs text-gray-400">от доходов</div>
                    </div> 
                </div>
                <div class="w-40 h-40 rounded-full border-8 border-gray-700">
                    
                </div>
            </div>
        </div>
        
        
        <div class="space-y-3" id="expenseCategories">
            
            <div class="flex items-center justify-between p-3 bg-gray-800/40 rounded-xl">
                <div class="flex items-center">
                    <div class="w-3 h-3 rounded-full bg-red-500 mr-3"></div>
                    <div>
                        <p class="font-medium text-sm">Еда</p>
                        <p class="text-xs text-gray-400">35% расходов</p>
                    </div>
                </div>
                <div class="text-right">
                    <p class="font-bold text-red-400 text-sm">-2,450 <span class="currency-symbol text-xs">с</span></p>
                    <p class="text-xs text-gray-400">12 транзакций</p>
                </div>
            </div>
        </div>
    </div>
</div>


<div class="card-gradient rounded-2xl p-4 mb-4">
    <h2 class="text-lg font-bold mb-4 flex items-center">
        <i class="fas fa-lightbulb text-yellow-400 mr-2"></i>
        Рекомендации
    </h2>
    
    <div class="space-y-3" id="recommendationsList">
        
        <div class="bg-gradient-to-r from-yellow-500/10 to-orange-500/10 rounded-xl p-3 border border-yellow-500/20">
            <div class="flex items-start space-x-3">
                <div class="w-8 h-8 rounded-lg bg-yellow-500/20 flex items-center justify-center flex-shrink-0 mt-1">
                    <i class="fas fa-utensils text-yellow-400 text-sm"></i>
                </div>
                <div>
                    <h3 class="font-semibold text-yellow-400 text-sm mb-1">Снижение расходов на еду</h3>
                    <p class="text-xs text-gray-300">
                        Вы тратите 35% доходов на еду. Попробуйте планировать покупки заранее.
                    </p>
                </div>
            </div>
        </div>
        
        
        <div class="bg-gradient-to-r from-blue-500/10 to-cyan-500/10 rounded-xl p-3 border border-blue-500/20">
            <div class="flex items-start space-x-3">
                <div class="w-8 h-8 rounded-lg bg-blue-500/20 flex items-center justify-center flex-shrink-0 mt-1">
                    <i class="fas fa-piggy-bank text-blue-400 text-sm"></i>
                </div>
                <div>
                    <h3 class="font-semibold text-blue-400 text-sm mb-1">Увеличьте резерв</h3>
                    <p class="text-xs text-gray-300">
                        Откладывайте 15% вместо 10% для быстрого достижения финансовой цели.
                    </p>
                </div>
            </div>
        </div>
    </div>
    
    
    <button class="w-full mt-4 bg-gray-800 hover:bg-gray-700 text-gray-300 py-3 rounded-xl text-sm font-medium transition-colors flex items-center justify-center">
        <i class="fas fa-robot mr-2"></i>
        Получить AI-рекомендации
    </button>
</div>


<div class="card-gradient rounded-2xl p-4">
    <h2 class="text-lg font-bold mb-4 flex items-center">
        <i class="fas fa-chart-bar text-green-400 mr-2"></i>
        Сравнение с прошлым периодом
    </h2>
    
    <div class="space-y-4">
        <div class="grid grid-cols-2 gap-4">
            <div class="text-center">
                <p class="text-xs text-gray-400 mb-1">Текущий месяц</p>
                <div class="text-lg font-bold text-green-400">+15,000</div>
                <div class="text-xs text-gray-400">доходы</div>
            </div>
            
            <div class="text-center">
                <p class="text-xs text-gray-400 mb-1">Прошлый месяц</p>
                <div class="text-lg font-bold text-blue-400">+13,400</div>
                <div class="text-xs text-gray-400">доходы</div>
            </div>
        </div>
        
        <div class="bg-gray-800/40 rounded-xl p-3">
            <div class="flex justify-between items-center mb-2">
                <span class="text-sm text-gray-300">Рост доходов</span>
                <span class="text-sm font-bold text-green-400">+12%</span>
            </div>
            <div class="w-full bg-gray-700 rounded-full h-2">
                <div class="bg-green-500 h-2 rounded-full" style="width: 65%"></div>
            </div>
        </div>
        
        <div class="bg-gray-800/40 rounded-xl p-3">
            <div class="flex justify-between items-center mb-2">
                <span class="text-sm text-gray-300">Снижение расходов</span>
                <span class="text-sm font-bold text-red-400">-5%</span>
            </div>
            <div class="w-full bg-gray-700 rounded-full h-2">
                <div class="bg-red-500 h-2 rounded-full" style="width: 35%"></div>
            </div>
        </div>
    </div>
</div>
-->
        </div>
    </div>
</div> 