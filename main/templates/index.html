{% load static %}
<!DOCTYPE html>
<html lang="ru">
<head>
    <!-- PWA –º–µ—Ç–∞-—Ç–µ–≥–∏ -->
    <meta name="application-name" content="coinza">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="coinza">
    <meta name="description" content="–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —É—á–µ—Ç–∞ –ª–∏—á–Ω—ã—Ö —Ñ–∏–Ω–∞–Ω—Å–æ–≤">
    <meta name="format-detection" content="telephone=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="msapplication-TileColor" content="#3b82f6">
    <meta name="msapplication-tap-highlight" content="no">
    <meta name="theme-color" content="#3b82f6">

    <!-- Apple Touch Icons -->
    <link rel="apple-touch-icon" href="{% static 'main/icons/icon-152x152.png' %}">
    <link rel="apple-touch-icon" sizes="152x152" href="{% static 'main/icons/icon-152x152.png' %}">
    <link rel="apple-touch-icon" sizes="180x180" href="{% static 'main/icons/icon-192x192.png' %}">
    <link rel="apple-touch-icon" sizes="167x167" href="{% static 'main/icons/icon-152x152.png' %}">

    <!-- Manifest -->
    <link rel="manifest" href="{% static 'main/manifest.json' %}">

    <!-- Favicon -->
    <link rel="icon" type="image/png" href="{% static 'main/icons/icon-32x32.png' %}" sizes="32x32">
    <link rel="icon" type="image/png" href="{% static 'main/icons/icon-16x16.png' %}" sizes="16x16">

    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">

    <title>Coinza - –£–ø—Ä–∞–≤–ª—è–π —Ñ–∏–Ω–∞–Ω—Å–∞–º–∏ –ø—Ä–æ—Å—Ç–æ!</title>
    <meta name="theme-color" content="#0f172a">

    <!-- CDN –∏ –ª–æ–∫–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="{% static 'main/style.css' %}">
</head>

<body class="gradient-bg text-gray-100 min-h-screen">
    <form style="display:none;">{% csrf_token %}</form>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è -->
    <div class="app-container">
<!-- –í–µ—Ä—Ö–Ω–∏–π –±–∞—Ä —Å –ª–æ–≥–æ—Ç–∏–ø–æ–º, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ–º –∏ –º–µ–Ω—é -->
<div class="mobile-header px-4 h-14 flex items-center justify-between">
  <div class="flex items-center h-full">
    <!-- –ö–Ω–æ–ø–∫–∞ –ª–æ–≥–æ—Ç–∏–ø–∞ —Å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π -->
    <button id="notificationLogoBtn2" class="relative flex items-center justify-center h-10 w-10 focus:outline-none bg-transparent border-none p-0 hover:bg-gray-700/30 rounded-lg transition-colors">
        <img src="{% static 'main/ico.svg' %}" alt="coinza" class="h-7">
        <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –Ω–æ–≤—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π -->
        <div id="notificationIndicator2" class="absolute top-3.3 -right-3 w-3 h-3 bg-green-500 rounded-full border-2 border-gray-900 shadow-lg pulse-indicator hidden"></div>
    </button>
  </div>

  <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –í–ù–£–¢–†–ò —Ö–µ–¥–µ—Ä–∞ -->
  <div id="notificationContainer"></div>
  
  <button id="menuBtn" class="w-9 h-9 bg-gray-800 hover:bg-gray-700 rounded-lg flex items-center justify-center transition-colors">
    <i class="fas fa-ellipsis-v text-gray-300 text-sm"></i>
  </button>
</div>


<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π -->
<div id="notificationsModal2" class="fixed inset-0 backdrop-blur-sm hidden z-[1000] bg-black bg-opacity-60 flex items-center justify-center p-4">
    <div class="modal-content bg-gray-800 rounded-2xl w-full max-w-sm mx-auto h-[70vh] flex flex-col">
        <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
        <div class="p-4 border-b border-gray-700 flex items-center justify-between">
            <h2 class="text-xl font-bold flex items-center">
                <i class="fas fa-bell text-yellow-400 mr-2"></i>
                –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
            </h2>
            <div class="flex items-center space-x-2">
                <button class="text-gray-400 hover:text-white p-1 rounded transition-colors" title="–ü–æ–º–µ—Ç–∏—Ç—å –≤—Å–µ –∫–∞–∫ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ">
                    <i class="fas fa-check-double text-sm"></i>
                </button>
                <button id="closeNotificationsModal2" class="text-gray-400 hover:text-white p-1 rounded transition-colors">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        </div>

        <!-- –§–∏–ª—å—Ç—Ä—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π -->
        <div class="p-3 border-b border-gray-700">
            <div class="flex space-x-1 bg-gray-700 rounded-lg p-1">
                <button class="filter-notification-btn flex-1 py-1.5 px-2 rounded text-xs font-medium transition-all active:scale-95 bg-blue-600 text-white" data-filter="all">
                    –í—Å–µ
                </button>
                <button class="filter-notification-btn flex-1 py-1.5 px-2 rounded text-xs font-medium transition-all active:scale-95 bg-gray-700 text-gray-300" data-filter="unread">
                    –ù–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ
                </button>
                <button class="filter-notification-btn flex-1 py-1.5 px-2 rounded text-xs font-medium transition-all active:scale-95 bg-gray-700 text-gray-300" data-filter="system">
                    –°–∏—Å—Ç–µ–º–Ω—ã–µ
                </button>
            </div>
        </div>

        <!-- –°–ø–∏—Å–æ–∫ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π -->
        <div class="flex-1 overflow-y-auto p-2">
            <div class="space-y-2" id="notificationsList2">
                <!-- –ü—Ä–∏–º–µ—Ä —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è - –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω–æ–µ -->
                <div class="notification-item bg-blue-500/10 border border-blue-500/20 rounded-xl p-3 animate-fadeIn cursor-pointer hover:bg-blue-500/15 transition-all" data-unread="true">
                    <div class="flex items-start space-x-3">
                        <div class="w-8 h-8 rounded-full bg-blue-500/20 flex items-center justify-center flex-shrink-0 mt-1">
                            <i class="fas fa-piggy-bank text-blue-400 text-sm"></i>
                        </div>
                        <div class="flex-1 min-w-0">
                            <div class="flex items-start justify-between mb-1">
                                <h3 class="text-sm font-semibold text-white truncate">–î–æ—Å—Ç–∏–≥–Ω—É—Ç–∞ —Ü–µ–ª—å —Ä–µ–∑–µ—Ä–≤–∞! üéâ</h3>
                                <span class="text-xs text-blue-400 font-medium ml-2 whitespace-nowrap">—Ç–æ–ª—å–∫–æ —á—Ç–æ</span>
                            </div>
                            <p class="text-xs text-gray-300 leading-relaxed">
                                –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –í—ã –¥–æ—Å—Ç–∏–≥–ª–∏ —Å–≤–æ–µ–π —Ü–µ–ª–∏ –ø–æ –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—é 50,000 —Å. –ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ!
                            </p>
                            <div class="flex items-center space-x-2 mt-2">
                                <span class="inline-block w-2 h-2 bg-blue-400 rounded-full animate-pulse"></span>
                                <span class="text-xs text-blue-400">–ù–æ–≤–æ–µ</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- –ü—Ä–∏–º–µ—Ä —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è - –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω–æ–µ -->
                <div class="notification-item bg-gray-700/30 border border-gray-600/30 rounded-xl p-3 cursor-pointer hover:bg-gray-700/50 transition-all" data-unread="false">
                    <div class="flex items-start space-x-3">
                        <div class="w-8 h-8 rounded-full bg-green-500/20 flex items-center justify-center flex-shrink-0 mt-1">
                            <i class="fas fa-chart-line text-green-400 text-sm"></i>
                        </div>
                        <div class="flex-1 min-w-0">
                            <div class="flex items-start justify-between mb-1">
                                <h3 class="text-sm font-semibold text-gray-300 truncate">–ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
                                <span class="text-xs text-gray-500 font-medium ml-2 whitespace-nowrap">2 —á –Ω–∞–∑–∞–¥</span>
                            </div>
                            <p class="text-xs text-gray-400 leading-relaxed">
                                –ù–∞ —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ –≤—ã —Å—ç–∫–æ–Ω–æ–º–∏–ª–∏ –Ω–∞ 15% –±–æ–ª—å—à–µ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –ø—Ä–µ–¥—ã–¥—É—â–µ–π. –û—Ç–ª–∏—á–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç!
                            </p>
                        </div>
                    </div>
                </div>

                <!-- –ü—Ä–∏–º–µ—Ä —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è - —Å–∏—Å—Ç–µ–º–∞ -->
                <div class="notification-item bg-purple-500/10 border border-purple-500/20 rounded-xl p-3 cursor-pointer hover:bg-purple-500/15 transition-all" data-unread="false">
                    <div class="flex items-start space-x-3">
                        <div class="w-8 h-8 rounded-full bg-purple-500/20 flex items-center justify-center flex-shrink-0 mt-1">
                            <i class="fas fa-robot text-purple-400 text-sm"></i>
                        </div>
                        <div class="flex-1 min-w-0">
                            <div class="flex items-start justify-between mb-1">
                                <h3 class="text-sm font-semibold text-white truncate">–ù–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–æ—Å—Ç—É–ø–Ω—ã</h3>
                                <span class="text-xs text-purple-400 font-medium ml-2 whitespace-nowrap">–≤—á–µ—Ä–∞</span>
                            </div>
                            <p class="text-xs text-gray-300 leading-relaxed">
                                –¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å —Ü–µ–ª–∏ –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π –∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.
                            </p>
                            <div class="flex items-center space-x-2 mt-2">
                                <span class="text-xs text-purple-400 font-medium">–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- –ü—Ä–∏–º–µ—Ä —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è - –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ -->
                <div class="notification-item bg-yellow-500/10 border border-yellow-500/20 rounded-xl p-3 cursor-pointer hover:bg-yellow-500/15 transition-all" data-unread="true">
                    <div class="flex items-start space-x-3">
                        <div class="w-8 h-8 rounded-full bg-yellow-500/20 flex items-center justify-center flex-shrink-0 mt-1">
                            <i class="fas fa-exclamation-triangle text-yellow-400 text-sm"></i>
                        </div>
                        <div class="flex-1 min-w-0">
                            <div class="flex items-start justify-between mb-1">
                                <h3 class="text-sm font-semibold text-white truncate">–ü—Ä–µ–≤—ã—à–µ–Ω –±—é–¥–∂–µ—Ç</h3>
                                <span class="text-xs text-yellow-400 font-medium ml-2 whitespace-nowrap">2 –¥–Ω—è –Ω–∞–∑–∞–¥</span>
                            </div>
                            <p class="text-xs text-gray-300 leading-relaxed">
                                –í—ã –ø—Ä–µ–≤—ã—Å–∏–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –ª–∏–º–∏—Ç –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ "–†–µ—Å—Ç–æ—Ä–∞–Ω—ã" –Ω–∞ 1,250 —Å.
                            </p>
                            <div class="flex items-center space-x-2 mt-2">
                                <span class="inline-block w-2 h-2 bg-yellow-400 rounded-full animate-pulse"></span>
                                <span class="text-xs text-yellow-400">–í–Ω–∏–º–∞–Ω–∏–µ</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- –ü—É—Å—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ -->
            <div id="emptyNotificationsState2" class="text-center py-8 text-gray-500 hidden">
                <div class="w-16 h-16 mx-auto mb-3 rounded-full bg-gray-700 flex items-center justify-center">
                    <i class="fas fa-bell-slash text-2xl text-gray-500"></i>
                </div>
                <p class="text-gray-400">–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –ø–æ–∫–∞ –Ω–µ—Ç</p>
                <p class="text-sm text-gray-500 mt-1">–ó–¥–µ—Å—å –±—É–¥—É—Ç –ø–æ—è–≤–ª—è—Ç—å—Å—è –≤–∞–∂–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è</p>
            </div>
        </div>

        <!-- –ù–∏–∂–Ω—è—è –ø–∞–Ω–µ–ª—å -->
        <div class="p-3 border-t border-gray-700 bg-gray-800/80">
            <div class="flex items-center justify-between text-xs text-gray-400">
                <span>–í—Å–µ–≥–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π: <span id="notificationsCount2">4</span></span>
                <button class="text-blue-400 hover:text-blue-300 transition-colors">
                    –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
                </button>
            </div>
        </div>
    </div>
</div>


        <!-- –ì–ª–∞–≤–Ω–∞—è –≤–∫–ª–∞–¥–∫–∞ -->
        <div class="mobile-tab active" id="tab-home">
            <div class="mobile-section">
                <div class="mobile-content">
                 <!-- –û—Å–Ω–æ–≤–Ω–æ–π –±–∞–ª–∞–Ω—Å ‚Äî –æ–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–π –¥–∏–∑–∞–π–Ω -->
<div class="relative bg-gradient-to-r from-blue-900/30 to-purple-900/30 rounded-2xl p-5 mb-4 -mt-2 border border-blue-800/30 shadow-lg overflow-hidden">
    <!-- –ë–æ–ª—å—à–∞—è —Ñ–æ–Ω–æ–≤–∞—è –∏–∫–æ–Ω–∫–∞ -->
    <i class="fas fa-dollar-sign text-[110px] text-blue-800/20 absolute top-3 right-4"></i>

    <div class="flex justify-between items-start relative z-10">
        <!-- –õ–µ–≤–∞—è —á–∞—Å—Ç—å -->
        <div>
            <p class="text-sm text-gray-300 mb-1">–¢–µ–∫—É—â–∏–π –±–∞–ª–∞–Ω—Å</p>
            <p class="text-3xl font-bold text-white">
                <span id="totalBalance" data-raw-value="{{ total|floatformat:0 }}">{{ total|floatformat:0 }}</span>
            </p>

            <!-- –†–µ–∑–µ—Ä–≤ -->
            <div class="mt-3 flex items-center space-x-2">
                <span class="text-sm text-gray-300">–†–µ–∑–µ—Ä–≤:</span>
                <span class="text-blue-400 font-semibold text-lg" id="reserveAmount" data-raw-value="{{ current_reserve|floatformat:0 }}">{{ current_reserve|floatformat:0 }}</span>
                <span class="text-blue-400 text-sm">—Å</span>
            </div>
        </div>
    </div>

    <!-- –ù–∏–∂–Ω–∏–π –±–ª–æ–∫ ‚Äî –î–æ—Ö–æ–¥—ã, –†–∞—Å—Ö–æ–¥—ã, –®–∫–∞–ª–∞ -->
    <div class="mt-5 relative z-10">
        <div class="flex justify-between items-end mb-2">
            <div class="text-left">
                <p class="text-xs text-gray-400 mb-1">–î–æ—Ö–æ–¥—ã</p>
                <p class="text-green-400 text-sm font-semibold" id="monthIncome" data-raw-value="{{ income|floatformat:0 }}">{{ income|floatformat:0 }} —Å</p>
            </div>
            <div class="text-right">
                <p class="text-xs text-gray-400 mb-1">–†–∞—Å—Ö–æ–¥—ã</p>
                <p class="text-red-400 text-sm font-semibold" id="monthExpense" data-raw-value="{{ expense|floatformat:0 }}">{{ expense|floatformat:0 }} —Å</p>
            </div>
        </div>

        <!-- –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä -->
        <div class="w-full bg-gray-700/50 rounded-full h-2 overflow-hidden">
            {% if income > 0 or expense > 0 %}
            <div class="flex h-2 rounded-full">
                <div class="bg-green-500 h-2 rounded-l-full"
                     style="width: {% widthratio income income|add:expense 100 %}%"></div>
                <div class="bg-red-500 h-2 rounded-r-full"
                     style="width: {% widthratio expense income|add:expense 100 %}%"></div>
            </div>
            {% else %}
            <div class="bg-gray-600 h-2 rounded-full"></div>
            {% endif %}
        </div>
    </div>
</div>
                    <!-- –í–∫–ª–∞–¥–∫–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π -->
                    <div class="card-gradient rounded-2xl  mb-4">
                        <div class="tabs-container" id="tabsContainer">
                            <div class="tabs-wrapper" id="tabsWrapper">
                                <!-- –í–∫–ª–∞–¥–∫–∞ "–í—Å–µ" -->
                                <div class="tab active" data-category="all">
                                    <span>–í—Å–µ</span>
                                </div>
                                <!-- –í–∫–ª–∞–¥–∫–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π -->
                                {% for category in categories %}
                                <div class="tab" data-category="{{ category.id }}">
                                    <span>{{ category.name }}</span>
                                </div>
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                    
<!-- –ò—Å—Ç–æ—Ä–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π -->
<div class="card-gradient rounded-2xl ">
    <div class="flex justify-between items-center mb-3">
        <h2 class="text-lg font-bold">–ò—Å—Ç–æ—Ä–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π</h2>
        <!-- –ö–Ω–æ–ø–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞ -->
        <div class="relative ">
            <button id="filterToggleBtn" class="bg-gray-800 hover:bg-gray-600 px-3 py-2 rounded-lg text-sm flex items-center space-x-2 transition-colors ">
                <span id="currentFilterText">–ó–∞ –Ω–µ–¥–µ–ª—é</span>
                
            </button>
            <!-- –í—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫ -->
            <div id="filterDropdown" class="absolute right-0 top-full mt-2 bg-gray-800 border border-gray-700 rounded-lg shadow-xl hidden min-w-40">
                <button class="filter-option w-full text-left px-4 py-3 hover:bg-gray-700 text-sm transition-colors border-b border-gray-700" data-filter="day">
                   –ó–∞ –¥–µ–Ω—å
                </button>
                <button class="filter-option w-full text-left px-4 py-3 hover:bg-gray-700 text-sm transition-colors border-b border-gray-700" data-filter="week">
                   –ó–∞ –Ω–µ–¥–µ–ª—é
                </button>
                <button class="filter-option w-full text-left px-4 py-3 hover:bg-gray-700 text-sm transition-colors" data-filter="month">
                   –ó–∞ –º–µ—Å—è—Ü
                </button>
            </div>
        </div>
    </div>
    
    <div class="space-y-3" id="transactionsListContainer">
        <!-- –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
    </div>
    
    <!-- –ö–Ω–æ–ø–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –µ—â–µ -->
    <div id="loadMoreContainer" class="mt-4 text-center hidden">
        <button id="loadMoreBtn" class="bg-gray-700 hover:bg-gray-600 text-white px-6 py-2 rounded-lg text-sm transition-colors">
            –ó–∞–≥—Ä—É–∑–∏—Ç—å –µ—â–µ
        </button>
    </div>
    
    <!-- –ü—É—Å—Ç—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è -->
    <div class="text-center py-8 text-gray-500 hidden" id="emptyStateAll">
        <i class="fas fa-receipt text-3xl mb-3"></i>
        <p>–û–ø–µ—Ä–∞—Ü–∏–π –ø–æ–∫–∞ –Ω–µ—Ç!</p>
    </div>
    
    <div class="text-center py-8 text-gray-500 hidden" id="emptyStateFiltered">
        <i class="fas fa-receipt text-3xl mb-3"></i>
        <p>–í —ç—Ç–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø—É—Å—Ç–æ!</p>
    </div>
</div>
                </div>
            </div>
        </div>
        
        <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –≤–∫–ª–∞–¥–∫–∞ -->
        <div class="mobile-tab mt-2" id="tab-categories">
            <div class="mobile-section">
                <div class="card-gradient rounded-2xl ">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-lg font-bold mb-4 flex items-center">
                    <i class="fa-solid fa-icons text-blue-400 mr-2"></i>
                    –ú–æ–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
                </h2>

                       <button class="bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-800 dark:text-gray-200 px-3 mb-4 py-1.5 rounded-lg text-sm font-medium transition-colors duration-200 mb-3" id="addCategoryBtn">
    <i class="fas fa-plus mr-1"></i> –î–æ–±–∞–≤–∏—Ç—å
</button>
                    </div>
                    
                    <div class="space-y-3 overflow-y-auto" id="categoriesList">
                        <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                        <div class="text-center py-8 text-gray-500" id="emptyCategoriesState">
                            <i class="fas fa-tags text-3xl mb-3"></i>
                            <p>–ö–∞—Ç–µ–≥–æ—Ä–∏–π –ø–æ–∫–∞ –Ω–µ—Ç</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

       <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤–∫–ª–∞–¥–∫–∞ - –ü–û–õ–ù–´–ô –†–ï–î–ò–ó–ê–ô–ù -->
<div class="mobile-tab" id="tab-stats">
    <div class="mobile-section">
        <div class="mobile-content">


     <!-- –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –±–ª–æ–∫ "–†–µ–∑–µ—Ä–≤ –∏ —Å–±–µ—Ä–µ–∂–µ–Ω–∏—è" —Å –Ω–æ–≤—ã–º –¥–∏–∑–∞–π–Ω–æ–º -->
<div class="card-gradient rounded-2xl  mb-4">
    <h2 class="text-lg font-bold mb-4 flex items-center">
        <i class="fas fa-piggy-bank text-blue-400 mr-2"></i>
        –ú–æ–∏ —Å–±–µ—Ä–µ–∂–µ–Ω–∏—è
    </h2>
    
    <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –≤—ã–∫–ª—é—á–µ–Ω–Ω–æ–º —Ä–µ–∑–µ—Ä–≤–µ -->
    <div id="reserveNotification" class="mb-4 bg-gradient-to-r from-red-500/10 to-orange-500/10 rounded-xl p-4 border border-red-500/30 animate-fadeIn {% if reserve_percentage != 0 %}hidden{% endif %}">
        <div class="flex items-start space-x-3">
            <div class="w-10 h-10 rounded-lg bg-red-500/20 flex items-center justify-center flex-shrink-0 mt-1">
                <i class="fas fa-exclamation-triangle text-red-400 text-lg"></i>
            </div>
            <div class="flex-1">
                <h3 class="font-semibold text-red-400 text-sm mb-1">–†–µ–∑–µ—Ä–≤ –æ—Ç–∫–ª—é—á–µ–Ω</h3>
                <p class="text-xs text-gray-300">
                    –§—É–Ω–∫—Ü–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ä–µ–∑–µ—Ä–≤–∞ –æ—Ç–∫–ª—é—á–µ–Ω–∞. –í–∫–ª—é—á–∏—Ç–µ –µ–µ –≤ –ø–∞–Ω–µ–ª–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è, 
                    —á—Ç–æ–±—ã –æ—Ç–∫–ª–∞–¥—ã–≤–∞—Ç—å –ø—Ä–æ—Ü–µ–Ω—Ç –æ—Ç –¥–æ—Ö–æ–¥–æ–≤ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.
                </p>
            </div>
        </div>
    </div>
    
    <div class="space-y-4">
        <!-- –¢–µ–∫—É—â–∏–π —Ä–µ–∑–µ—Ä–≤ -->
        <div class="bg-gradient-to-r from-blue-900/30 to-purple-900/30 rounded-xl p-4 border border-blue-800/30">
            <div class="flex justify-between items-center">
                <div>
                    <p class="text-sm text-gray-300">–¢–µ–∫—É—â–∏–π —Ä–µ–∑–µ—Ä–≤</p>
                    <p class="text-2xl font-bold text-blue-400 mt-1">
                        <span id="currentReserveAmount" data-raw-value="{{ current_reserve|floatformat:0 }}">{{ current_reserve|floatformat:0 }}</span> 
                        <span class="currency-symbol text-lg">—Å</span>
                    </p>
                </div>
                <div class="text-right">
                    <p class="text-sm text-gray-300">–ü—Ä–æ—Ü–µ–Ω—Ç –æ—Ç –¥–æ—Ö–æ–¥–æ–≤</p>
                    <p class="text-lg font-bold text-green-400 mt-1">
                        <span id="reservePercentageDisplay">{{ reserve_percentage }}</span>%
                    </p>
                </div>
            </div>
            
            
        </div>
        

            <!-- –û–ë–ù–û–í–õ–ï–ù–ù–´–ô –ë–õ–û–ö –¶–ï–õ–ï–í–û–ì–û –†–ï–ó–ï–†–í–ê -->
<div class="bg-gradient-to-br from-purple-500/10 to-pink-500/10 rounded-xl p-4 border border-purple-500/20">
    <div class="flex items-center justify-between mb-4">
        <div class="flex items-center space-x-2">
            <div class="w-8 h-8 rounded-lg bg-purple-500/20 flex items-center justify-center">
                <i class="fas fa-bullseye text-purple-400"></i>
            </div>
            <div>
                <p class="text-sm font-semibold text-purple-400">–¶–µ–ª–µ–≤–æ–π —Ä–µ–∑–µ—Ä–≤</p>
                <p class="text-xs text-gray-400">–í–∞—à–∞ —Ñ–∏–Ω–∞–Ω—Å–æ–≤–∞—è —Ü–µ–ª—å</p>
            </div>
        </div>
        <div class="text-right">
            <p class="text-lg font-bold text-purple-400">
                <span id="targetReserveAmount" data-raw-value="{{ target_reserve|floatformat:0 }}">{{ target_reserve|floatformat:0 }}</span> —Å
            </p>
        </div>
    </div>
    
    <!-- –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å -->
    <div class="space-y-3">
        <div class="flex justify-between items-center">
            <span class="text-xs text-gray-400">–ü—Ä–æ–≥—Ä–µ—Å—Å</span>
            <span class="text-xs font-bold text-yellow-400" id="remainingToTargetText">
                –û—Å—Ç–∞–ª–æ—Å—å: <span id="remainingToTarget" data-raw-value="{{ remaining_to_target|floatformat:0 }}">{{ remaining_to_target|floatformat:0 }}</span> —Å
            </span>
        </div>
        
        <!-- –û—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä -->
        <div class="w-full bg-gray-700 rounded-full h-3 relative overflow-hidden">
            <div id="targetProgressBar" class="bg-gradient-to-r from-purple-500 to-pink-500 h-3 rounded-full transition-all duration-1000 relative" 
                 style="width: {{ progress_percentage }}%">
                <!-- –ê–Ω–∏–º–∞—Ü–∏—è "—Å–∏—è–Ω–∏—è" –Ω–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–µ -->
                <div class="absolute inset-0 bg-gradient-to-r from-transparent via-white/30 to-transparent animate-pulse-slow"></div>
            </div>
        </div>
        
        <!-- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–æ–≥—Ä–µ—Å—Å–µ -->
        <div class="grid grid-cols-3 gap-2 text-center">
            <div class="text-xs text-gray-400">
                <div class="font-bold text-blue-400" id="targetCurrentReserve" data-raw-value="{{ current_reserve|floatformat:0 }}">{{ current_reserve|floatformat:0 }}</div>
                <div>–ù–∞–∫–æ–ø–ª–µ–Ω–æ</div>
            </div>
            <div class="text-xs text-gray-400">
                <div class="font-bold text-yellow-400" id="targetRemaining" data-raw-value="{{ remaining_to_target|floatformat:0 }}">{{ remaining_to_target|floatformat:0 }}</div>
                <div>–û—Å—Ç–∞–ª–æ—Å—å</div>
            </div>
            <div class="text-xs text-gray-400">
                <div class="font-bold text-green-400" id="targetProgressPercent">{{ progress_percentage|floatformat:1 }}%</div>
                <div>–í—ã–ø–æ–ª–Ω–µ–Ω–æ</div>
            </div>
        </div>
    </div>
    
    <!-- –ú–æ—Ç–∏–≤–∞—Ü–∏–æ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ -->
    <div class="mt-3 text-center" id="motivationMessage">
        {% if progress_percentage == 100 %}
        <div class="bg-gradient-to-r from-green-500/20 to-emerald-500/20 rounded-lg p-2 border border-green-500/30">
            <p class="text-xs text-green-400 font-semibold">
                <i class="fas fa-trophy mr-1"></i>–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –¶–µ–ª—å –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–∞!
            </p>
        </div>
        {% elif progress_percentage > 75 %}
        <p class="text-xs text-yellow-400 animate-pulse">
            <i class="fas fa-fire mr-1"></i>–û—Å—Ç–∞–ª–æ—Å—å —Å–æ–≤—Å–µ–º –Ω–µ–º–Ω–æ–≥–æ!
        </p>
        {% elif progress_percentage > 50 %}
        <p class="text-xs text-blue-400">
            <i class="fas fa-rocket mr-1"></i>–û—Ç–ª–∏—á–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å!
        </p>
        {% elif progress_percentage > 25 %}
        <p class="text-xs text-purple-400">
            <i class="fas fa-seedling mr-1"></i>–ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ!
        </p>
        {% else %}
        <p class="text-xs text-gray-400">
            <i class="fas fa-flag mr-1"></i>–ù–∞—á–Ω–∏—Ç–µ —Å–≤–æ–π –ø—É—Ç—å –∫ —Ü–µ–ª–∏
        </p>
        {% endif %}
    </div>
</div>


        <!-- –û–ë–ù–û–í–õ–ï–ù–ù–ê–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ê –†–ï–ó–ï–†–í–ê -->
        <div class="grid grid-cols-2 gap-3">
            <!-- –û—Ç–ª–æ–∂–µ–Ω–æ –≤ —ç—Ç–æ–º –º–µ—Å—è—Ü–µ - –Ω–æ–≤—ã–π –¥–∏–∑–∞–π–Ω -->
            <div class="bg-gradient-to-br from-blue-500/10 to-blue-600/10 rounded-xl p-4 border border-blue-500/20 hover:border-blue-400/40 transition-all duration-300 group">
                <div class="flex items-center justify-between mb-2">
                    <div class="w-8 h-8 rounded-lg bg-blue-500/20 flex items-center justify-center group-hover:scale-110 transition-transform">
                        <i class="fas fa-calendar-plus text-blue-400 text-sm"></i>
                    </div>
                    <div class="text-right">
                        <div class="w-3 h-3 rounded-full bg-blue-400 animate-pulse"></div>
                    </div>
                </div>
                <p class="text-xs text-gray-400 mb-1">–û—Ç–ª–æ–∂–µ–Ω–æ –≤ —ç—Ç–æ–º –º–µ—Å—è—Ü–µ</p>
                <p class="text-xl font-bold text-blue-400 group-hover:text-blue-300 transition-colors">
                    +<span id="monthlyReserveAmount" data-raw-value="{{ monthly_reserve|floatformat:0 }}">{{ monthly_reserve|floatformat:0 }}</span>
                </p>
                <div class="mt-2 w-full bg-blue-500/20 rounded-full h-1">
                    <div class="bg-blue-400 h-1 rounded-full transition-all duration-500" style="width: {% widthratio monthly_reserve current_reserve 100 %}%"></div>
                </div>
            </div>
            
            <!-- –í—Å–µ–≥–æ –Ω–∞–∫–æ–ø–ª–µ–Ω–æ - –Ω–æ–≤—ã–π –¥–∏–∑–∞–π–Ω -->
            <div class="bg-gradient-to-br from-green-500/10 to-green-600/10 rounded-xl p-4 border border-green-500/20 hover:border-green-400/40 transition-all duration-300 group">
                <div class="flex items-center justify-between mb-2">
                    <div class="w-8 h-8 rounded-lg bg-green-500/20 flex items-center justify-center group-hover:scale-110 transition-transform">
                        <i class="fas fa-chart-line text-green-400 text-sm"></i>
                    </div>
                    <div class="text-right">
                        <i class="fas fa-trophy text-green-400 text-sm"></i>
                    </div>
                </div>
                <p class="text-xs text-gray-400 mb-1">–í—Å–µ–≥–æ –Ω–∞–∫–æ–ø–ª–µ–Ω–æ</p>
                <p class="text-xl font-bold text-green-400 group-hover:text-green-300 transition-colors">
                    <span id="totalReserveAmount" data-raw-value="{{ current_reserve|floatformat:0 }}">{{ current_reserve|floatformat:0 }}</span>
                </p>
                <div class="mt-2 flex items-center space-x-1">
                    <div class="text-xs text-green-400">
                        <i class="fas fa-arrow-up"></i>
                    </div>
                    <div class="text-xs text-gray-400">—Ä–∞—Å—Ç–µ—Ç –∫–∞–∂–¥—ã–π –º–µ—Å—è—Ü</div>
                </div>
            </div>
        </div>

 
    </div>
</div>
            <!-- –ê–Ω–∞–ª–∏–∑ —Ä–∞—Å—Ö–æ–¥–æ–≤ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º -->
          
         <!-- 
<div class="card-gradient rounded-2xl p-4 mb-4">
    <h2 class="text-lg font-bold mb-4 flex items-center">
        <i class="fas fa-chart-pie text-purple-400 mr-2"></i>
        –ê–Ω–∞–ª–∏–∑ —Ä–∞—Å—Ö–æ–¥–æ–≤
    </h2> 
    
    <div class="space-y-4">
        
        <div class="flex items-center justify-center py-4">
            <div class="relative w-40 h-40">
                
                <div class="absolute inset-0 flex items-center justify-center">
                    <div class="text-center">
                        <div class="text-2xl font-bold text-white" id="expensePercentage">0%</div>
                        <div class="text-xs text-gray-400">–æ—Ç –¥–æ—Ö–æ–¥–æ–≤</div>
                    </div> 
                </div>
                <div class="w-40 h-40 rounded-full border-8 border-gray-700">
                    
                </div>
            </div>
        </div>
        
        
        <div class="space-y-3" id="expenseCategories">
            
            <div class="flex items-center justify-between p-3 bg-gray-800/40 rounded-xl">
                <div class="flex items-center">
                    <div class="w-3 h-3 rounded-full bg-red-500 mr-3"></div>
                    <div>
                        <p class="font-medium text-sm">–ï–¥–∞</p>
                        <p class="text-xs text-gray-400">35% —Ä–∞—Å—Ö–æ–¥–æ–≤</p>
                    </div>
                </div>
                <div class="text-right">
                    <p class="font-bold text-red-400 text-sm">-2,450 <span class="currency-symbol text-xs">—Å</span></p>
                    <p class="text-xs text-gray-400">12 —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π</p>
                </div>
            </div>
        </div>
    </div>
</div>


<div class="card-gradient rounded-2xl p-4 mb-4">
    <h2 class="text-lg font-bold mb-4 flex items-center">
        <i class="fas fa-lightbulb text-yellow-400 mr-2"></i>
        –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
    </h2>
    
    <div class="space-y-3" id="recommendationsList">
        
        <div class="bg-gradient-to-r from-yellow-500/10 to-orange-500/10 rounded-xl p-3 border border-yellow-500/20">
            <div class="flex items-start space-x-3">
                <div class="w-8 h-8 rounded-lg bg-yellow-500/20 flex items-center justify-center flex-shrink-0 mt-1">
                    <i class="fas fa-utensils text-yellow-400 text-sm"></i>
                </div>
                <div>
                    <h3 class="font-semibold text-yellow-400 text-sm mb-1">–°–Ω–∏–∂–µ–Ω–∏–µ —Ä–∞—Å—Ö–æ–¥–æ–≤ –Ω–∞ –µ–¥—É</h3>
                    <p class="text-xs text-gray-300">
                        –í—ã —Ç—Ä–∞—Ç–∏—Ç–µ 35% –¥–æ—Ö–æ–¥–æ–≤ –Ω–∞ –µ–¥—É. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –ø–æ–∫—É–ø–∫–∏ –∑–∞—Ä–∞–Ω–µ–µ.
                    </p>
                </div>
            </div>
        </div>
        
        
        <div class="bg-gradient-to-r from-blue-500/10 to-cyan-500/10 rounded-xl p-3 border border-blue-500/20">
            <div class="flex items-start space-x-3">
                <div class="w-8 h-8 rounded-lg bg-blue-500/20 flex items-center justify-center flex-shrink-0 mt-1">
                    <i class="fas fa-piggy-bank text-blue-400 text-sm"></i>
                </div>
                <div>
                    <h3 class="font-semibold text-blue-400 text-sm mb-1">–£–≤–µ–ª–∏—á—å—Ç–µ —Ä–µ–∑–µ—Ä–≤</h3>
                    <p class="text-xs text-gray-300">
                        –û—Ç–∫–ª–∞–¥—ã–≤–∞–π—Ç–µ 15% –≤–º–µ—Å—Ç–æ 10% –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–π —Ü–µ–ª–∏.
                    </p>
                </div>
            </div>
        </div>
    </div>
    
    
    <button class="w-full mt-4 bg-gray-800 hover:bg-gray-700 text-gray-300 py-3 rounded-xl text-sm font-medium transition-colors flex items-center justify-center">
        <i class="fas fa-robot mr-2"></i>
        –ü–æ–ª—É—á–∏—Ç—å AI-—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
    </button>
</div>


<div class="card-gradient rounded-2xl p-4">
    <h2 class="text-lg font-bold mb-4 flex items-center">
        <i class="fas fa-chart-bar text-green-400 mr-2"></i>
        –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –ø—Ä–æ—à–ª—ã–º –ø–µ—Ä–∏–æ–¥–æ–º
    </h2>
    
    <div class="space-y-4">
        <div class="grid grid-cols-2 gap-4">
            <div class="text-center">
                <p class="text-xs text-gray-400 mb-1">–¢–µ–∫—É—â–∏–π –º–µ—Å—è—Ü</p>
                <div class="text-lg font-bold text-green-400">+15,000</div>
                <div class="text-xs text-gray-400">–¥–æ—Ö–æ–¥—ã</div>
            </div>
            
            <div class="text-center">
                <p class="text-xs text-gray-400 mb-1">–ü—Ä–æ—à–ª—ã–π –º–µ—Å—è—Ü</p>
                <div class="text-lg font-bold text-blue-400">+13,400</div>
                <div class="text-xs text-gray-400">–¥–æ—Ö–æ–¥—ã</div>
            </div>
        </div>
        
        <div class="bg-gray-800/40 rounded-xl p-3">
            <div class="flex justify-between items-center mb-2">
                <span class="text-sm text-gray-300">–†–æ—Å—Ç –¥–æ—Ö–æ–¥–æ–≤</span>
                <span class="text-sm font-bold text-green-400">+12%</span>
            </div>
            <div class="w-full bg-gray-700 rounded-full h-2">
                <div class="bg-green-500 h-2 rounded-full" style="width: 65%"></div>
            </div>
        </div>
        
        <div class="bg-gray-800/40 rounded-xl p-3">
            <div class="flex justify-between items-center mb-2">
                <span class="text-sm text-gray-300">–°–Ω–∏–∂–µ–Ω–∏–µ —Ä–∞—Å—Ö–æ–¥–æ–≤</span>
                <span class="text-sm font-bold text-red-400">-5%</span>
            </div>
            <div class="w-full bg-gray-700 rounded-full h-2">
                <div class="bg-red-500 h-2 rounded-full" style="width: 35%"></div>
            </div>
        </div>
    </div>
</div>
-->
        </div>
    </div>
</div> 
        
<!-- –ó–∞–º–µ—Ç–∫–∏ –≤–∫–ª–∞–¥–∫–∞ -->
<div class="mobile-tab mt-2" id="tab-notes">
    <div class="mobile-section">
      <div class="mobile-content">
        <div class="card-gradient rounded-2xl">
            <div class="flex justify-between items-center -mt-5 mb-4">
                 <h2 class="text-lg font-bold mb-4 flex items-center">
                    <i class="fa-solid fa-feather-pointed text-blue-400 mr-2"></i>
                    –£–º–Ω—ã–µ –∑–∞–º–µ—Ç–∫–∏
                </h2>
               <button class="bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-800 dark:text-gray-200 px-3 py-1.5 rounded-lg text-sm font-medium transition-colors duration-200 mb-3  add-note-btn">
    <i class="fas fa-plus mr-2"></i>–î–æ–±–∞–≤–∏—Ç—å
</button>
            </div>
            
            <div class="space-y-3 max-h-96 categories-scroll" id="notesList">
                <!-- –ó–ê–ú–ï–ù–ò–¢–ï –≠–¢–û–¢ –ë–õ–û–ö –ù–ê –ù–û–í–´–ô –î–ò–ó–ê–ô–ù -->
                <div class="text-center py-6 px-4" id="emptyNotesState">
                    <!-- –ì–ª–∞–≤–Ω–∞—è –∏–∫–æ–Ω–∫–∞ -->
                    <div class="w-20 h-20 mx-auto mb-4 rounded-2xl bg-gradient-to-br from-blue-500/20 to-purple-600/20 flex items-center justify-center">
                        <i class="fas fa-sticky-note text-3xl text-blue-400"></i>
                    </div>
                    
                    <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
                    <h3 class="text-xl font-bold text-white mb-3">–í–∞—à–∏ —É–º–Ω—ã–µ –∑–∞–º–µ—Ç–∫–∏</h3>
                    
                    <!-- –û–ø–∏—Å–∞–Ω–∏–µ -->
                    <p class="text-gray-400 text-sm mb-6 max-w-sm mx-auto">
                        –°–æ–∑–¥–∞–≤–∞–π—Ç–µ –∑–∞–º–µ—Ç–∫–∏ —Å –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è–º–∏ –∏ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ —É–ø—É—Å–∫–∞–π—Ç–µ –≤–∞–∂–Ω–æ–µ
                    </p>
                    
                    <!-- –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –≤ –≤–∏–¥–µ –∫–∞—Ä—Ç–æ—á–µ–∫ -->
                    <div class="grid gap-3 mb-6">
                        <!-- –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è -->
                        <div class="flex items-start space-x-3 p-3 bg-gray-800/40 rounded-xl border border-gray-700/50">
                            <div class="w-8 h-8 rounded-lg bg-blue-500/20 flex items-center justify-center flex-shrink-0">
                                <i class="fas fa-bell text-blue-400 text-sm"></i>
                            </div>
                            <div class="text-left">
                                <h4 class="text-white text-sm font-semibold">–£–º–Ω—ã–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è</h4>
                                <p class="text-gray-400 text-xs">–ü–æ–ª—É—á–∞–π—Ç–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Ç–æ—á–Ω–æ –≤ —Å—Ä–æ–∫</p>
                            </div>
                        </div>
                        
                        <!-- –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è -->
                        <div class="flex items-start space-x-3 p-3 bg-gray-800/40 rounded-xl border border-gray-700/50">
                            <div class="w-8 h-8 rounded-lg bg-green-500/20 flex items-center justify-center flex-shrink-0">
                                <i class="fas fa-layer-group text-green-400 text-sm"></i>
                            </div>
                            <div class="text-left">
                                <h4 class="text-white text-sm font-semibold">–í—Å–µ –ø–æ–¥ –∫–æ–Ω—Ç—Ä–æ–ª–µ–º</h4>
                                <p class="text-gray-400 text-xs">–ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞–π—Ç–µ –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –≤ –ª—é–±–æ–µ –≤—Ä–µ–º—è</p>
                            </div>
                        </div>
                        
                        <!-- –ë—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø -->
                        <div class="flex items-start space-x-3 p-3 bg-gray-800/40 rounded-xl border border-gray-700/50">
                            <div class="w-8 h-8 rounded-lg bg-purple-500/20 flex items-center justify-center flex-shrink-0">
                                <i class="fas fa-rocket text-purple-400 text-sm"></i>
                            </div>
                            <div class="text-left">
                                <h4 class="text-white text-sm font-semibold">–ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø</h4>
                                <p class="text-gray-400 text-xs">–í–∞—à–∏ –º—ã—Å–ª–∏ –≤—Å–µ–≥–¥–∞ –ø–æ–¥ —Ä—É–∫–æ–π</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- –ü—Ä–∏–∑—ã–≤ –∫ –¥–µ–π—Å—Ç–≤–∏—é -->
                   <button class="add-note-btn w-full bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-500 hover:to-purple-500 text-white font-semibold py-3 px-6 rounded-xl transition-all duration-200 transform hover:scale-105 active:scale-95 shadow-lg"
        onclick="openAddNoteModal()">
    <i class="fas fa-plus mr-2"></i>
    –°–æ–∑–¥–∞—Ç—å –ø–µ—Ä–≤—É—é –∑–∞–º–µ—Ç–∫—É
</button>
                    
                    <!-- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –º–æ—Ç–∏–≤–∞—Ü–∏—è -->
                  
                </div>
            </div>
        </div>
    </div>
</div>
</div>


    <!-- –ù–∏–∂–Ω–µ–µ –º–µ–Ω—é –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ -->
<div class="mobile-nav">
    <div class="mobile-nav-item active" data-tab="home">
        <i class="fas fa-home"></i>
        <span>–ì–ª–∞–≤–Ω–∞—è</span>
    </div>
    
    <div class="mobile-nav-item" data-tab="categories">
        <i class="fas fa-tags"></i>
        <span>–ö–∞—Ç–µ–≥–æ—Ä–∏–∏</span>
    </div>
    
    <div class="mobile-nav-center">
        <!-- –ü–æ–¥—Å–∫–∞–∑–∫–∞ –¥–ª—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
       <!-- –ü—Ä–æ—Å—Ç–æ –∑–∞–º–µ–Ω–∏—Ç–µ –±–ª–æ–∫ welcomeHint –Ω–∞ —ç—Ç–æ—Ç -->
{% if not has_transactions %}
<!-- –ü—Ä–æ—Å—Ç–æ –∑–∞–º–µ–Ω–∏—Ç–µ –±–ª–æ–∫ welcomeHint –Ω–∞ —ç—Ç–æ—Ç -->
<div id="welcomeHint" class="fixed bottom-20 inset-x-0 text-center animate-bounce z-50 {% if has_transactions %}hidden{% endif %}">
    <div class="bg-blue-600 text-white text-sm rounded-lg py-2 px-3 mb-1 inline-block shadow-lg">
        –°–¥–µ–ª–∞–π –ø–µ—Ä–≤—É—é —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é!
    </div>
    <div class="text-white text-2xl">‚Üì</div>
</div>
{% endif %}
        
        <div class="mobile-nav-item-center" id="openTransactionModalBtn">
            <i class="fas fa-plus"></i>
        </div>
    </div>
    
    <div class="mobile-nav-item" data-tab="stats">
        <i class="fas fa-chart-pie"></i>
        <span>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</span>
    </div>
    
    <div class="mobile-nav-item" data-tab="notes">
        <i class="fas fa-sticky-note"></i>
        <span>–ó–∞–º–µ—Ç–∫–∏</span>
    </div>
</div>

    
  
    </div> <!-- –ö–æ–Ω–µ—Ü .app-container -->

   <!-- –í —Ñ–∞–π–ª–µ index.html –∑–∞–º–µ–Ω–∏—Ç–µ –±–ª–æ–∫ —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏ –≤ –º–æ–¥–∞–ª–∫–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ -->
<div id="transactionModal" class="fixed inset-0 backdrop-blur-sm hidden z-[1000] bg-black bg-opacity-60 flex items-center justify-center p-4">
    <div class="modal-content bg-gray-800 rounded-2xl w-full max-w-sm mx-auto">
        <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
        <div class="p-4 border-b border-gray-700">
            <h2 class="text-xl font-bold text-center">–î–æ–±–∞–≤–∏—Ç—å –∑–∞–ø–∏—Å—å</h2>
        </div>

        <form id="transactionForm" class="p-4 space-y-4">
            {% csrf_token %}
            <input type="hidden" name="category" id="selectedCategory">

            <!-- –ü–æ–ª–µ —Å—É–º–º—ã -->
            <div class="text-center">
                <input id="amountInput" name="amount" type="text" inputmode="decimal" required
                       placeholder="0.00"
                       class="w-full p-4 rounded-lg bg-gray-700 text-white text-center text-3xl font-bold border-2 border-gray-600 focus:border-blue-500 outline-none">
               
            </div>

            <!-- –¶–∏—Ñ—Ä–æ–≤–∞—è –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ -->
            <div class="grid grid-cols-3 gap-2">
                <button type="button" class="keypad-btn bg-gray-700 hover:bg-gray-600 active:bg-gray-500 p-3 rounded-lg text-xl font-medium transition-all active:scale-95">1</button>
                <button type="button" class="keypad-btn bg-gray-700 hover:bg-gray-600 active:bg-gray-500 p-3 rounded-lg text-xl font-medium transition-all active:scale-95">2</button>
                <button type="button" class="keypad-btn bg-gray-700 hover:bg-gray-600 active:bg-gray-500 p-3 rounded-lg text-xl font-medium transition-all active:scale-95">3</button>
                <button type="button" class="keypad-btn bg-gray-700 hover:bg-gray-600 active:bg-gray-500 p-3 rounded-lg text-xl font-medium transition-all active:scale-95">4</button>
                <button type="button" class="keypad-btn bg-gray-700 hover:bg-gray-600 active:bg-gray-500 p-3 rounded-lg text-xl font-medium transition-all active:scale-95">5</button>
                <button type="button" class="keypad-btn bg-gray-700 hover:bg-gray-600 active:bg-gray-500 p-3 rounded-lg text-xl font-medium transition-all active:scale-95">6</button>
                <button type="button" class="keypad-btn bg-gray-700 hover:bg-gray-600 active:bg-gray-500 p-3 rounded-lg text-xl font-medium transition-all active:scale-95">7</button>
                <button type="button" class="keypad-btn bg-gray-700 hover:bg-gray-600 active:bg-gray-500 p-3 rounded-lg text-xl font-medium transition-all active:scale-95">8</button>
                <button type="button" class="keypad-btn bg-gray-700 hover:bg-gray-600 active:bg-gray-500 p-3 rounded-lg text-xl font-medium transition-all active:scale-95">9</button>
                <button type="button" class="keypad-btn bg-gray-700 hover:bg-gray-600 active:bg-gray-500 p-3 rounded-lg text-xl font-medium transition-all active:scale-95">00</button>
                <button type="button" class="keypad-btn bg-gray-700 hover:bg-gray-600 active:bg-gray-500 p-3 rounded-lg text-xl font-medium transition-all active:scale-95">0</button>
                <button type="button" class="keypad-btn bg-gray-700 hover:bg-gray-600 active:bg-gray-500 p-3 rounded-lg text-xl font-medium transition-all active:scale-95">
                    <i class="fas fa-backspace"></i>
                </button>
            </div>

            <!-- –¢–∏–ø –æ–ø–µ—Ä–∞—Ü–∏–∏ -->
            <div class="flex gap-2">
                <button type="button" class="type-btn flex-1 py-3 rounded-lg font-semibold transition-all active:scale-95 bg-red-600 text-white border-2 border-red-600" data-type="expense">
                    –†–∞—Å—Ö–æ–¥
                </button>
                <button type="button" class="type-btn flex-1 py-3 rounded-lg font-semibold transition-all active:scale-95 bg-gray-700 text-gray-300 border-2 border-gray-600" data-type="income">
                    –î–æ—Ö–æ–¥
                </button>
            </div>

            <!-- –ö–Ω–æ–ø–∫–∞ –≤—ã–±–æ—Ä–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ -->
            <div>
              
                <button type="button" id="openCategorySelectionBtn" class="w-full p-4 rounded-lg bg-gray-700 hover:bg-gray-600 border-2 border-gray-600 hover:border-blue-500 text-white font-semibold transition-all duration-200 flex items-center justify-between">
                    <span id="selectedCategoryDisplay" class="flex items-center">
                        <i class="fas fa-tag mr-2 text-gray-400"></i>
                        <span>–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é</span>
                    </span>
                    <i class="fas fa-chevron-right text-gray-400"></i>
                </button>
            </div>

            <!-- –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π -->
            <div>
                <input id="descriptionInput" name="description" type="text" 
                       placeholder="–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)"
                       class="w-full p-3 rounded-lg bg-gray-700 text-white border border-gray-600 focus:border-blue-500 outline-none">
            </div>

            <!-- –ö–Ω–æ–ø–∫–∏ -->
            <div class="flex gap-3 pt-2">
                <button type="button" id="closeTransactionModalBtn" 
                        class="flex-1 py-3 rounded-lg bg-gray-700 text-gray-300 hover:bg-gray-600 transition-colors font-semibold">
                    –û—Ç–º–µ–Ω–∞
                </button>
                <button type="submit" 
                        class="flex-1 py-3 rounded-lg bg-blue-600 hover:bg-blue-700 text-white font-semibold transition-colors">
                    –î–æ–±–∞–≤–∏—Ç—å
                </button>
            </div>
        </form>
    </div>
</div>

<!-- –ù–æ–≤–∞—è –º–æ–¥–∞–ª–∫–∞ –≤—ã–±–æ—Ä–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ -->
<div id="categorySelectionModal" class="fixed inset-0 backdrop-blur-sm hidden z-[1100] bg-black bg-opacity-60 flex items-center justify-center p-4">
    <div class="modal-content bg-gray-800 rounded-2xl w-full max-w-sm mx-auto h-[80vh] flex flex-col">
        <!-- –°–ø–∏—Å–æ–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–π -->
        <div class="flex-1 overflow-y-auto p-4">
            <div class="space-y-2" id="categorySelectionList">
                <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>
            
            <!-- –ü—É—Å—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ -->
            <div id="emptyCategoriesSelection" class="text-center py-8 text-gray-500 hidden">
                <i class="fas fa-tags text-3xl mb-3"></i>
                <p>–ö–∞—Ç–µ–≥–æ—Ä–∏–π –ø–æ–∫–∞ –Ω–µ—Ç</p>
                <p class="text-sm mt-2">–°–æ–∑–¥–∞–π—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –≤ —Ä–∞–∑–¥–µ–ª–µ "–ö–∞—Ç–µ–≥–æ—Ä–∏–∏"</p>
            </div>
        </div>

        <!-- –ö–Ω–æ–ø–∫–∞ –û—Ç–º–µ–Ω–∏—Ç—å –≤–Ω–∏–∑—É -->
        <div class="p-4 border-t border-gray-700 flex-shrink-0">
            <button type="button" id="closeCategorySelectionBtn" 
                    class="w-full py-3 rounded-lg bg-gray-700 hover:bg-gray-600 text-white font-semibold transition-colors">
                –û—Ç–º–µ–Ω–∏—Ç—å
            </button>
        </div>
    </div>
</div>

<div id="noteModal" class="fixed inset-0 backdrop-blur-sm hidden z-[1000] bg-black bg-opacity-60 flex items-center justify-center p-4">
    <div class="modal-content bg-gray-800 rounded-2xl w-full max-w-sm mx-auto">
        <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
        <div class="p-4 border-b border-gray-700">
            <h2 class="text-xl font-bold text-center" id="noteModalTitle">–ù–æ–≤–∞—è –∑–∞–º–µ—Ç–∫–∞</h2>
        </div>

        <div class="p-6">
            <div class="space-y-4">
                <div>
                    <input type="text" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ" class="input-field" id="noteTitleInput">
                </div>
                
                <div>
                    <textarea placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –∑–∞–º–µ—Ç–∫–∏" rows="6" class="input-field" id="noteContentInput"></textarea>
                </div>
                
                <!-- –ù–æ–≤—ã–π –∫—Ä–∞—Å–∏–≤—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –≤—ã–±–æ—Ä–∞ –¥–∞—Ç—ã –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è -->
                <!-- –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –±–ª–æ–∫ –≤—ã–±–æ—Ä–∞ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è -->
<div>
    <label class="block text-gray-300 mb-3">
        <i class="fas fa-bell mr-2 text-blue-400"></i>
        –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
    </label>
    
    <!-- –û—Å–Ω–æ–≤–Ω–æ–µ –ø–æ–ª–µ –≤—ã–±–æ—Ä–∞ –¥–∞—Ç—ã –∏ –≤—Ä–µ–º–µ–Ω–∏ -->
    <div class="space-y-3">
        <div class="grid grid-cols-2 gap-2">
            <div>
                <label class="block text-gray-400 text-xs mb-1">–î–∞—Ç–∞</label>
                <input type="date" id="reminderDateInput" 
                       class="w-full p-2 rounded bg-gray-700 border border-gray-600 text-white text-sm focus:border-blue-500 outline-none">
            </div>
            <div>
                <label class="block text-gray-400 text-xs mb-1">–í—Ä–µ–º—è</label>
                <input type="time" id="reminderTimeInput" 
                       class="w-full p-2 rounded bg-gray-700 border border-gray-600 text-white text-sm focus:border-blue-500 outline-none">
            </div>
        </div>
        
        <!-- –ö–Ω–æ–ø–∫–∞ –æ—á–∏—Å—Ç–∫–∏ -->
        <button type="button" id="clearReminderBtn" 
                class="w-full py-2 bg-gray-700 hover:bg-gray-600 text-gray-300 rounded text-sm transition-colors">
            <i class="fas fa-times mr-1"></i> –ë–µ–∑ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è
        </button>
    </div>
    
    <p class="text-xs text-gray-400 mt-2">
        –û—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º, –µ—Å–ª–∏ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –Ω–µ –Ω—É–∂–Ω–æ.
    </p>
</div>
            </div>
            
            <div class="flex justify-end gap-3 mt-6">
                <button class="btn-secondary close-modal" data-modal="note">
                    –û—Ç–º–µ–Ω–∞
                </button>
                <button class="btn-primary w-full py-3" id="saveNoteBtn">
                    –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
                </button>
            </div>
        </div>
    </div>
</div>

  <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∑–∞–º–µ—Ç–∫–∏ -->
<div id="viewNoteModal" class="modal hidden fixed inset-0 z-50 overflow-y-auto">
    <div class="modal-backdrop fixed inset-0 bg-black/50"></div>
    <div class="modal-container flex items-center justify-center min-h-screen p-4">
        <div class="modal-content max-w-lg w-full bg-white dark:bg-gray-800 rounded-2xl shadow-lg border border-gray-200 dark:border-gray-700">
            <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
            <div class="modal-header px-6 py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">
                <h2 id="viewNoteTitle" class="text-lg font-semibold text-gray-900 dark:text-white"></h2>
                <button class="close-modal text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 transition-colors" data-modal="viewNote">
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <!-- –¢–µ–ª–æ –º–æ–¥–∞–ª–∫–∏ -->
            <div class="modal-body p-6 space-y-4">
                <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∑–∞–º–µ—Ç–∫–µ -->
                <div id="viewNoteInfo" class="flex flex-wrap gap-2"></div>

                <!-- –ë–ª–æ–∫ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è -->
                <div id="viewNoteReminderInfo" class="hidden"></div>

                <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –∑–∞–º–µ—Ç–∫–∏ -->
                <div class="bg-gray-50 dark:bg-gray-900 rounded-md p-4 border border-gray-200 dark:border-gray-700">
                    <p id="viewNoteContent" class="text-gray-700 dark:text-gray-300 whitespace-pre-wrap leading-relaxed"></p>
                </div>

                <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –∫–Ω–æ–ø–æ–∫ –¥–µ–π—Å—Ç–≤–∏–π -->
                <div class="modal-actions mt-6"></div>
            </div>
        </div>
    </div>
</div>





 <div id="categoryModal" class="fixed inset-0 backdrop-blur-sm hidden z-[1000] bg-black bg-opacity-60 flex items-center justify-center p-4">
        <div class="modal-content bg-gray-800 rounded-2xl w-full max-w-sm mx-auto">

            <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
            <div class="p-4 border-b border-gray-700">
                <h2 class="text-xl font-bold text-center">–î–æ–±–∞–≤–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é</h2>
            </div>

            <div class="p-6">


                <div class="space-y-4">
                    <div>

                        <input type="text" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏" class="input-field" id="categoryNameInput">
                    </div>

                    <div>
                        <label class="block text-gray-300 mb-2">–ò–∫–æ–Ω–∫–∞</label>
                        <div class="grid grid-cols-4 gap-2" id="iconsGrid">
                            <!-- –ò–∫–æ–Ω–∫–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                        </div>
                    </div>

                    <div>
                        <label class="block text-gray-300 mb-2">–¶–≤–µ—Ç</label>
                        <div class="grid grid-cols-5 gap-2" id="colorsGrid">
                            <!-- –¶–≤–µ—Ç–∞ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                        </div>
                    </div>
                </div>

                <div class="flex justify-end gap-3 mt-6">
                    <button class="btn-secondary close-modal" data-modal="category">
                        –û—Ç–º–µ–Ω–∞
                    </button>
                    <button class="btn-primary" id="saveCategoryBtn" type="button">
                        –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
                    </button>
                </div>
            </div>
        </div>
    </div>


<div id="transactionDetailModal" class="fixed inset-0 z-[9999] bg-black bg-opacity-60 flex items-center justify-center p-4 hidden">
    <div class="modal-content bg-gray-800 rounded-2xl w-full max-w-sm mx-auto shadow-2xl border border-gray-700">
        <!-- –¢–µ–ª–æ —á–µ–∫–∞ -->
        <div class="p-6 space-y-6 text-white">
            <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å —Å—É–º–º–æ–π -->
            <div class="text-center">
                <p id="detailAmount" class="text-4xl font-bold mb-2"></p>
            </div>

            <!-- –ë–ª–æ–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏ —Ä–µ–∑–µ—Ä–≤–∞ -->
            <div class="flex items-center justify-between p-4 bg-gray-700/30 rounded-xl border border-gray-600">
                <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏—è —Å–ª–µ–≤–∞ -->
                <div class="flex items-center space-x-3">
                    <div id="detailCategoryIcon" class="w-12 h-12 rounded-xl flex items-center justify-center"></div>
                    <div class="text-left">
                        <p id="detailCategoryName" class="font-semibold text-lg text-gray-200"></p>
                        <p id="detailType" class="text-sm text-gray-400"></p>
                    </div>
                </div>
                
                <!-- –†–µ–∑–µ—Ä–≤ —Å–ø—Ä–∞–≤–∞ -->
                <div id="detailReserveInfo" class="hidden">
                    <div class="text-right">
                        <div class="flex items-center space-x-2 text-blue-400 justify-end">
                            <i class="fas fa-piggy-bank text-sm"></i>
                            <span class="text-xl font-medium">–†–µ–∑–µ—Ä–≤</span>
                        </div>
                         <span class="text-sm font-bold text-blue-300">+</span> <span id="detailReserveAmount" class="text-sm font-bold text-blue-300"></span>
                    </div>
                </div>
            </div>

        
            <!-- –î–µ—Ç–∞–ª–∏ –æ–ø–µ—Ä–∞—Ü–∏–∏ -->
            <div class="space-y-4">
                <!-- –û–ø–∏—Å–∞–Ω–∏–µ -->
                <div id="detailDescriptionSection">
                    <div class="bg-gray-700/30 rounded-lg p-3 border border-gray-600">
                        <p id="detailDescription" class="text-sm text-gray-300 whitespace-pre-wrap leading-relaxed"></p>
                    </div>
                </div>
            </div>

            <!-- –°—Ç–∞—Ç—É—Å –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
            <div class="bg-gray-700/30 rounded-lg p-4 border border-gray-600">
                <div class="flex items-center justify-center space-x-2 text-green-400 mb-2">
                    <i class="fas fa-check-circle"></i>
                    <span class="text-sm font-semibold">–û–ø–µ—Ä–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞</span>
                </div>
                <p class="text-xs text-gray-400 text-center" id="detailTimestamp"></p>
                
                <!-- ID —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ -->
                <div class="mt-2">
                    <p id="detailTransactionId" class="text-sm text-gray-300 text-center">-</p>
                </div>
            </div>
        </div>

        <!-- –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è -->
        <div class="p-4 border-t border-gray-700">
            <!-- –°–æ—Å—Ç–æ—è–Ω–∏–µ 1: –û–±—ã—á–Ω—ã–µ –∫–Ω–æ–ø–∫–∏ -->
            <div id="normalButtons" class="flex space-x-3">
                <button id="closeTransactionDetailModal" class="flex-1 py-3 rounded-lg bg-gray-700 hover:bg-gray-600 text-white font-semibold transition-colors">
                    –ó–∞–∫—Ä—ã—Ç—å
                </button>
                <button id="deleteTransactionBtn" class="flex-1 py-3 rounded-lg bg-red-600 hover:bg-red-500 text-white font-semibold transition-colors">
                    –£–¥–∞–ª–∏—Ç—å
                </button>
            </div>
            
            <!-- –°–æ—Å—Ç–æ—è–Ω–∏–µ 2: –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–∏—è -->
            <div id="confirmDeleteSection" class="hidden">
                <div class="text-center mb-3">
                    <p class="text-red-400 font-semibold">–£–¥–∞–ª–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é?</p>
                    <p class="text-gray-400 text-sm">–≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å!</p>
                </div>
                <div class="flex space-x-3">
                    <button id="cancelDeleteBtn" class="flex-1 py-3 rounded-lg bg-gray-700 hover:bg-gray-600 text-white font-semibold transition-colors">
                        –û—Ç–º–µ–Ω–∞
                    </button>
                    <button id="confirmDeleteBtn" class="flex-1 py-3 rounded-lg bg-red-600 hover:bg-red-500 text-white font-semibold transition-colors">
                        –î–∞, —É–¥–∞–ª–∏—Ç—å!
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>




<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–µ—Ç–∞–ª–µ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ -->
<div id="categoryDetailModal" class="fixed inset-0 z-[9999] bg-black bg-opacity-60 flex items-center justify-center p-4 hidden">
    <div class="modal-content bg-gray-800 rounded-2xl w-full max-w-sm mx-auto shadow-2xl border border-gray-700 max-h-[90vh] overflow-hidden">
        <!-- –¢–µ–ª–æ –º–æ–¥–∞–ª–∫–∏ -->
        <div class="p-6 space-y-6 text-white overflow-y-auto">
            <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å –∏–∫–æ–Ω–∫–æ–π, –Ω–∞–∑–≤–∞–Ω–∏–µ–º –∏ –∫–Ω–æ–ø–∫–æ–π —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ -->
            <div class="flex items-start justify-between">
                <div class="flex items-center space-x-4 flex-1">
                    <div id="categoryDetailIcon" class="w-12 h-12 rounded-xl flex items-center justify-center text-2xl"></div>
                    <div class="flex-1">
                        <h2 id="categoryDetailName" class="font-semibold text-lg text-gray-200 truncate w-[10ch]"></h2>
                        <p class="text-gray-400 text-sm">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</p>
                    </div>
                </div>
                <!-- –ö–Ω–æ–ø–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞ –ø–µ—Ä–∏–æ–¥–∞ -->
                <div class="relative">
                    <button id="categoryFilterToggleBtn" class="bg-gray-700 hover:bg-gray-600 px-3 py-2 rounded-lg text-sm flex items-center space-x-2 transition-colors">
                        <span id="categoryCurrentFilterText">–ó–∞ –º–µ—Å—è—Ü</span>
                        <i class="fas fa-chevron-down text-xs"></i>
                    </button>
                    <!-- –í—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫ -->
                    <div id="categoryFilterDropdown" class="absolute right-0 top-full mt-2 bg-gray-800 border border-gray-700 rounded-lg shadow-xl hidden min-w-40 z-10">
                        <button class="category-filter-option w-full text-left px-4 py-3 hover:bg-gray-700 text-sm transition-colors border-b border-gray-700" data-filter="day">
                            –ó–∞ –¥–µ–Ω—å
                        </button>
                        <button class="category-filter-option w-full text-left px-4 py-3 hover:bg-gray-700 text-sm transition-colors border-b border-gray-700" data-filter="week">
                            –ó–∞ –Ω–µ–¥–µ–ª—é
                        </button>
                        <button class="category-filter-option w-full text-left px-4 py-3 hover:bg-gray-700 text-sm transition-colors border-b border-gray-700" data-filter="month">
                            –ó–∞ –º–µ—Å—è—Ü
                        </button>
                        <button class="category-filter-option w-full text-left px-4 py-3 hover:bg-gray-700 text-sm transition-colors border-b border-gray-700" data-filter="3months">
                            –ó–∞ 3 –º–µ—Å—è—Ü–∞
                        </button>
                        <button class="category-filter-option w-full text-left px-4 py-3 hover:bg-gray-700 text-sm transition-colors" data-filter="year">
                            –ó–∞ –≥–æ–¥
                        </button>
                    </div>
                </div>
            </div>

            <!-- –û—Å–Ω–æ–≤–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤ –∫–∞—Ä—Ç–æ—á–∫–∞—Ö -->
            <div class="grid grid-cols-2 gap-3">
                <!-- –û–±—â–∏–µ —Ä–∞—Å—Ö–æ–¥—ã -->
                <div class="bg-gradient-to-br from-red-500/10 to-red-600/10 rounded-xl p-4 border border-red-500/20">
                    <div class="flex items-center justify-between mb-2">
                        <div class="w-8 h-8 rounded-lg bg-red-500/20 flex items-center justify-center">
                            <i class="fas fa-money-bill-wave text-red-400 text-sm"></i>
                        </div>
                        
                    </div>
                    <p class="text-gray-400 text-xs mb-1">–í—Å–µ–≥–æ –ø–æ—Ç—Ä–∞—á–µ–Ω–æ</p>
                    <p id="categoryTotalExpense" class="text-xl font-bold text-red-400">0 —Å</p>
                </div>

                <!-- –°—Ä–µ–¥–Ω–∏–π —á–µ–∫ -->
                <div class="bg-gradient-to-br from-purple-500/10 to-purple-600/10 rounded-xl p-4 border border-purple-500/20">
                    <div class="flex items-center justify-between mb-2">
                        <div class="w-8 h-8 rounded-lg bg-purple-500/20 flex items-center justify-center">
                            <i class="fas fa-receipt text-purple-400 text-sm"></i>
                        </div>
                        
                    </div>
                    <p class="text-gray-400 text-xs mb-1">–°—Ä–µ–¥–Ω–∏–π —á–µ–∫</p>
                    <p id="categoryAverageAmount" class="text-xl font-bold text-purple-400">0 —Å</p>
                </div>

                <!-- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–ø–µ—Ä–∞—Ü–∏–π -->
                <div class="bg-gradient-to-br from-blue-500/10 to-blue-600/10 rounded-xl p-4 border border-blue-500/20">
                    <div class="flex items-center justify-between mb-2">
                        <div class="w-8 h-8 rounded-lg bg-blue-500/20 flex items-center justify-center">
                            <i class="fas fa-calendar-day text-blue-400 text-sm"></i>
                        </div>
                        
                    </div>
                    <p class="text-gray-400 text-xs mb-1">–í—Å–µ–≥–æ –æ–ø–µ—Ä–∞—Ü–∏–π</p>
                    <p id="categoryTransactionsCount" class="text-xl font-bold text-blue-400">0</p>
                </div>

                <!-- –ü—Ä–æ—Ü–µ–Ω—Ç –æ—Ç —Ä–∞—Å—Ö–æ–¥–æ–≤ -->
                <div class="bg-gradient-to-br from-yellow-500/10 to-yellow-600/10 rounded-xl p-4 border border-yellow-500/20">
                    <div class="flex items-center justify-between mb-2">
                        <div class="w-8 h-8 rounded-lg bg-yellow-500/20 flex items-center justify-center">
                            <i class="fas fa-chart-pie text-yellow-400 text-sm"></i>
                        </div>
                        
                    </div>
                    <p class="text-gray-400 text-xs mb-1">–î–æ–ª—è —Ä–∞—Å—Ö–æ–¥–æ–≤</p>
                    <p id="categoryExpensePercentage" class="text-xl font-bold text-yellow-400">0%</p>
                </div>
            </div>
        </div>

        <!-- –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è -->
        <div class="p-4 border-t border-gray-700">
            <!-- –°–æ—Å—Ç–æ—è–Ω–∏–µ 1: –û–±—ã—á–Ω—ã–µ –∫–Ω–æ–ø–∫–∏ -->
            <div id="categoryNormalButtons" class="flex space-x-3">
                <button id="closeCategoryDetailModal" class="flex-1 py-3 rounded-lg bg-gray-700 hover:bg-gray-600 text-white font-semibold transition-colors">
                    –ó–∞–∫—Ä—ã—Ç—å
                </button>
                <button id="deleteCategoryDetailBtn" class="flex-1 py-3 rounded-lg bg-red-600 hover:bg-red-500 text-white font-semibold transition-colors hidden">
                    –£–¥–∞–ª–∏—Ç—å
                </button>
            </div>
            
            <!-- –°–æ—Å—Ç–æ—è–Ω–∏–µ 2: –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–∏—è -->
            <div id="categoryConfirmDeleteSection" class="hidden">
                <div class="text-center mb-3">
                    <p class="text-red-400 font-semibold">–£–¥–∞–ª–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é?</p>
                    <p class="text-gray-400 text-sm">–≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å</p>
                </div>
                <div class="flex space-x-3">
                    <button id="cancelCategoryDeleteBtn" class="flex-1 py-3 rounded-lg bg-gray-700 hover:bg-gray-600 text-white font-semibold transition-colors">
                        –û—Ç–º–µ–Ω–∞
                    </button>
                    <button id="confirmCategoryDeleteBtn" class="flex-1 py-3 rounded-lg bg-red-600 hover:bg-red-500 text-white font-semibold transition-colors">
                        –î–∞, —É–¥–∞–ª–∏—Ç—å!
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –º–µ–Ω—é -->
    <div id="menuModal" class="fixed inset-0 bg-black bg-opacity-60 backdrop-blur-sm hidden z-[1000] flex items-center justify-center p-4">
        <div class="modal-content bg-gray-800 rounded-2xl w-full max-w-sm mx-auto">
            <div class="p-6">
                <h2 class="text-2xl font-bold mb-6 text-center">–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è</h2>
                
                <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Å–º–µ–Ω—ã –ø–∞—Ä–æ–ª—è -->
                {% if not user.userprofile.password_changed %}
                <div class="bg-red-500/20 border border-red-500/30 rounded-xl p-4 mb-4">
                    <div class="flex items-start space-x-3">
                        <i class="fas fa-exclamation-triangle text-red-400 mt-1"></i>
                        <div>
                            <p class="text-red-400 font-semibold text-sm">–°–º–µ–Ω–∏—Ç–µ –ø–∞—Ä–æ–ª—å!</p>
                            <p class="text-red-300 text-xs mt-1">
                                –°–∏—Å—Ç–µ–º–∞ —Å–æ–∑–¥–∞–ª–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã–π –ø–∞—Ä–æ–ª—å. –ü—Ä–∏–¥—É–º–∞–π—Ç–µ —Å–≤–æ–π, —á—Ç–æ–±—ã –Ω–µ –ø–æ—Ç–µ—Ä—è—Ç—å –¥–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º.
                            </p>
                        </div>
                    </div>
                </div>
                {% endif %}
                
                <!-- –ë–ª–æ–∫ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ -->
                <div class="bg-gray-700 rounded-xl p-4 mb-6">
                    <div class="flex items-center justify-between">
                        <!-- –õ–µ–≤–∞—è —á–∞—Å—Ç—å: –∞–≤–∞—Ç–∞—Ä –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
                        <div class="flex items-center space-x-3">
                            <!-- –ê–≤–∞—Ç–∞—Ä -->
                            <div class="w-12 h-12 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center">
                                <i class="fas fa-user text-white text-lg"></i>
                            </div>
                            
                            <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
                            <div>
                                <p class="font-bold text-white text-lg">{{ user.username }}</p>
                                <p class="text-gray-300 text-sm">
                                    {% if user.email %}
                                        {{ user.email }}
                                    {% else %}
                                        email –Ω–µ —É–∫–∞–∑–∞–Ω
                                    {% endif %}
                                </p>
                            </div>
                        </div>
                        
                        <!-- –ü—Ä–∞–≤–∞—è —á–∞—Å—Ç—å: –∏–∫–æ–Ω–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π -->
                        <div class="flex items-center space-x-2">
                            <!-- –ò–∫–æ–Ω–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ (—Å–º–µ–Ω–∞ –ø–∞—Ä–æ–ª—è) -->
                            <button id="changePasswordBtn" class="w-10 h-10 rounded-full bg-gray-600 hover:bg-blue-600 flex items-center justify-center transition-colors group" title="–°–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å">
                                <i class="fas fa-cog text-gray-300 group-hover:text-white transition-colors"></i>
                            </button>
                            
                            <!-- –ò–∫–æ–Ω–∫–∞ –≤—ã—Ö–æ–¥–∞ -->
                            <a href="{% url 'logout' %}" class="w-10 h-10 rounded-full bg-gray-600 hover:bg-red-600 flex items-center justify-center transition-colors group" title="–í—ã–π—Ç–∏">
                                <i class="fas fa-sign-out-alt text-gray-300 group-hover:text-white transition-colors"></i>
                            </a>
                        </div>
                    </div>
                </div>
                
  <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ—Ü–µ–Ω—Ç–∞ —Ä–µ–∑–µ—Ä–≤–∞ -->
<div class="bg-gray-700/60 rounded-xl p-4 mb-6 border border-gray-600/50">
    <div class="flex items-center justify-between mb-3">
        <div class="flex items-center space-x-2">
            <div class="w-8 h-8 rounded-full bg-blue-500/20 flex items-center justify-center">
                <i class="fas fa-piggy-bank text-blue-400 text-sm"></i>
            </div>
            <h3 class="text-base font-semibold text-gray-200">–†–µ–∑–µ—Ä–≤</h3>
        </div>
        <span id="currentReservePercent" class="text-sm text-blue-400 font-medium">{{ reserve_percentage }}%</span>
    </div>

    <p class="text-sm text-gray-400 mb-3">
        –£–∫–∞–∂–∏—Ç–µ, —Å–∫–æ–ª—å–∫–æ –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤ –æ—Ç –¥–æ—Ö–æ–¥–æ–≤ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–∫–ª–∞–¥—ã–≤–∞—Ç—å –≤ —Ä–µ–∑–µ—Ä–≤.
    </p>

    <div class="flex items-center space-x-3 mb-4">
        <input
            type="number"
            id="reservePercentageInput"
            min="0"
            max="100"
            class="w-24 bg-gray-800 border border-gray-700 rounded-lg p-2 text-center text-white text-lg font-semibold focus:border-blue-500 focus:ring-0 outline-none transition-all"
            value="{{ reserve_percentage }}" 
        >
        <button
            id="saveReserveBtn"
            class="flex-1 bg-blue-600 hover:bg-blue-500 text-white px-3 w-full py-3 rounded-lg text-sm font-medium transition-all"
        >
            <i class="fas fa-save mr-2"></i>–°–æ—Ö—Ä–∞–Ω–∏—Ç—å
        </button>
    </div>



    <!-- –ù–æ–≤—ã–π –±–ª–æ–∫ –¥–ª—è —Ü–µ–ª–µ–≤–æ–≥–æ —Ä–µ–∑–µ—Ä–≤–∞ -->
    <div class="pt-4 border-t border-gray-600/50">
        <div class="flex items-center justify-between mb-3">
            <div class="flex items-center space-x-2">
                <div class="w-8 h-8 rounded-full bg-purple-500/20 flex items-center justify-center">
                    <i class="fas fa-bullseye text-purple-400 text-sm"></i>
                </div>
                <h3 class="text-base font-semibold text-gray-200">–¶–µ–ª–µ–≤–æ–π —Ä–µ–∑–µ—Ä–≤</h3>
            </div>
            <span id="currentTargetReserve" class="text-sm text-purple-400 font-medium">{{ target_reserve|floatformat:0 }} —Å</span>
        </div>

        <p class="text-sm text-gray-400 mb-3">
            –£–∫–∞–∂–∏—Ç–µ —Å—É–º–º—É, –∫–æ—Ç–æ—Ä—É—é —Ö–æ—Ç–∏—Ç–µ –Ω–∞–∫–æ–ø–∏—Ç—å.
        </p>

        <div class="flex items-center space-x-3">
            <input
                type="number"
                id="targetReserveInput"
                min="0"
                step="1000"
                class="w-24 bg-gray-800 border border-gray-700 rounded-lg p-2 text-center text-white text-lg font-semibold focus:border-purple-500 focus:ring-0 outline-none transition-all"
                value="{{ target_reserve|floatformat:0 }}"
            >
            <button
                id="saveTargetReserveBtn"
                class="flex-1 bg-blue-600 hover:bg-blue-500 text-white px-3 w-full py-3 rounded-lg text-sm font-medium transition-all"
            >
                <i class="fas fa-save mr-2"></i>–°–æ—Ö—Ä–∞–Ω–∏—Ç—å
            </button>
        </div>
    </div>
    
</div>


<button onclick="toggleMenuModal()" class="mt-6 w-full bg-gray-700 hover:bg-gray-600 text-white py-3 rounded-lg font-medium transition-colors">
                    –ó–∞–∫—Ä—ã—Ç—å
                </button>


    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–º–µ–Ω—ã –ø–∞—Ä–æ–ª—è -->
    <div id="changePasswordModal"
     class="fixed inset-0 bg-black bg-opacity-60 backdrop-blur-sm hidden z-[1000] flex items-center justify-center p-4">
    <div class="modal-content bg-gray-800 rounded-2xl w-full max-w-sm mx-auto p-6">
        <h2 class="text-xl font-bold mb-4 text-center">–°–º–µ–Ω–∞ –ø–∞—Ä–æ–ª—è</h2>
                
                <form id="changePasswordForm" class="space-y-4">
                    {% csrf_token %}
                    
                    <!-- –ü–æ–ª–µ –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ –ø–∞—Ä–æ–ª—è (–µ—Å–ª–∏ —É–∂–µ –º–µ–Ω—è–ª–∏) -->
                    <div id="currentPasswordField" class="hidden">
                        <input type="password" name="current_password" placeholder="–¢–µ–∫—É—â–∏–π –ø–∞—Ä–æ–ª—å" 
                               class="w-full p-3 rounded-lg bg-gray-700 text-white border border-gray-600 focus:border-blue-500 outline-none">
                    </div>
                    
                    <div>
                        <input type="password" name="new_password" placeholder="–ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å" required 
                               class="w-full p-3 rounded-lg bg-gray-700 text-white border border-gray-600 focus:border-blue-500 outline-none">
                    </div>
                    <div>
                        <input type="password" name="confirm_password" placeholder="–ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –ø–∞—Ä–æ–ª—å" required 
                               class="w-full p-3 rounded-lg bg-gray-700 text-white border border-gray-600 focus:border-blue-500 outline-none">
                    </div>
                    
                    <!-- –ö–Ω–æ–ø–∫–∞ —Å —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –∑–∞–≥—Ä—É–∑–∫–∏ -->
                    <button type="submit" class="change-password-submit-btn btn-primary w-full py-3 rounded-lg text-white font-semibold relative overflow-hidden">
                        <span class="change-password-btn-text">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å</span>
                        <div class="change-password-spinner hidden absolute inset-0 flex items-center justify-center">
                            <div class="w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"></div>
                        </div>
                    </button>
                </form>
                
                <button onclick="toggleChangePasswordModal()" class="mt-4 w-full text-gray-400 hover:text-white py-2 transition-colors">
                    –û—Ç–º–µ–Ω–∞
                </button>
            </div>
        </div>
    </div>







<script>
function urlBase64ToUint8Array(base64String) {
  const padding = '='.repeat((4 - (base64String.length % 4)) % 4);
  const base64 = (base64String + padding)
    .replace(/-/g, '+')
    .replace(/_/g, '/');

  const rawData = atob(base64);
  const outputArray = new Uint8Array(rawData.length);
  for (let i = 0; i < rawData.length; ++i) {
    outputArray[i] = rawData.charCodeAt(i);
  }
  return outputArray;
}

if ('serviceWorker' in navigator && 'PushManager' in window) {
  navigator.serviceWorker.register("{% static 'service-worker.js' %}")
    .then(() => {

      // –ñ–¥—ë–º –ø–æ–∫–∞ –æ–Ω —Å—Ç–∞–Ω–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã–º
      return navigator.serviceWorker.ready;
    })
    .then(async (reg) => {

      const appServerKey = urlBase64ToUint8Array("{{ vapid_key|safe }}");

      const subscription = await reg.pushManager.subscribe({
        userVisibleOnly: true,
        applicationServerKey: appServerKey
      });


     await fetch("/webpush/save_information/?group=notes", {
  method: "POST",
  headers: {
    "Content-Type": "application/json",
    "X-CSRFToken": "{{ csrf_token }}"
  },
  body: JSON.stringify(subscription)
});


    })
    .catch(err => console.error("‚ùå –û—à–∏–±–∫–∞ –ø–æ–¥–ø–∏—Å–∫–∏:", err));
}

</script>






<!-- index.html - –æ–±–Ω–æ–≤–ª—è–µ–º –±–ª–æ–∫ —Å –±–∞–ª–∞–Ω—Å–æ–º -->
<script>
    window.initialBalances = {
        total: {{ total|default:0 }},
        income: {{ income|default:0 }},
        expense: {{ expense|default:0 }},
        total_reserve: {{ current_reserve|default:0 }},
        monthly_reserve: {{ monthly_reserve|default:0 }}  // –¥–æ–±–∞–≤–ª—è–µ–º –º–µ—Å—è—á–Ω—ã–π —Ä–µ–∑–µ—Ä–≤
    };
    window.initialReservePercentage = {{ reserve_percentage|default:0 }};
    window.initialTargetReserve = {{ target_reserve|default:0 }};
</script>

<!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ Tailwind –∏ JS -->
    <script src="https://cdn.tailwindcss.com"></script>
<!-- –ü–æ—Å–ª–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è app.js -->
<script src="{% static 'main/app.js' %}"></script>
<script src="{% static 'main/categories-modal.js' %}"></script>
<script src="{% static 'main/notes.js' %}"></script>
<script src="{% static 'main/notification-logo.js' %}"></script>

    <script>
        // –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø–µ—Ä–≤–æ–π —Å–º–µ–Ω—ã –ø–∞—Ä–æ–ª—è
        let isFirstPasswordChange = {% if not user.userprofile.password_changed %}true{% else %}false{% endif %};

        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º–æ–¥–∞–ª–∫–æ–π —Å–º–µ–Ω—ã –ø–∞—Ä–æ–ª—è
        function toggleChangePasswordModal() {
            const modal = document.getElementById('changePasswordModal');
            modal.classList.toggle('hidden');
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ñ–æ—Ä–º—É
            document.getElementById('changePasswordForm').reset();
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–Ω–æ–ø–∫–∏
            setChangePasswordButtonLoading(false);
            document.querySelector('.change-password-submit-btn').classList.add('btn-primary');
            document.querySelector('.change-password-submit-btn').classList.remove('bg-red-600', 'cursor-not-allowed', 'bg-green-600');
        }

        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –∫–Ω–æ–ø–∫–∏ —Å–º–µ–Ω—ã –ø–∞—Ä–æ–ª—è
        function setChangePasswordButtonLoading(isLoading) {
            const btn = document.querySelector('.change-password-submit-btn');
            const btnText = btn.querySelector('.change-password-btn-text');
            const spinner = btn.querySelector('.change-password-spinner');
            
            if (btn && btnText && spinner) {
                if (isLoading) {
                    btn.disabled = true;
                    btnText.classList.add('opacity-0');
                    spinner.classList.remove('hidden');
                } else {
                    btn.disabled = false;
                    btnText.classList.remove('opacity-0');
                    spinner.classList.add('hidden');
                }
            }
        }

        function showChangePasswordButtonError(errorMessage) {
            const btn = document.querySelector('.change-password-submit-btn');
            const btnText = btn.querySelector('.change-password-btn-text');
            const spinner = btn.querySelector('.change-password-spinner');
            
            if (btn && btnText && spinner) {
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç
                const originalText = btnText.textContent;
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—à–∏–±–∫—É
                btn.disabled = true;
                spinner.classList.add('hidden');
                btnText.classList.remove('opacity-0');
                btnText.textContent = errorMessage;
                btn.classList.remove('btn-primary');
                btn.classList.add('bg-red-600', 'cursor-not-allowed');
                
                // –ß–µ—Ä–µ–∑ 4 —Å–µ–∫—É–Ω–¥—ã –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
                setTimeout(() => {
                    btn.disabled = false;
                    btnText.textContent = originalText;
                    btn.classList.add('btn-primary');
                    btn.classList.remove('bg-red-600', 'cursor-not-allowed');
                }, 2000);
            }
        }

        function showChangePasswordButtonSuccess(successMessage) {
            const btn = document.querySelector('.change-password-submit-btn');
            const btnText = btn.querySelector('.change-password-btn-text');
            const spinner = btn.querySelector('.change-password-spinner');
            
            if (btn && btnText && spinner) {
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É—Å–ø–µ—Ö
                btn.disabled = true;
                spinner.classList.add('hidden');
                btnText.classList.remove('opacity-0');
                btnText.textContent = successMessage;
                btn.classList.remove('btn-primary');
                btn.classList.add('bg-green-600', 'cursor-not-allowed');
                
                // –¢–æ–ª—å–∫–æ –ø—Ä–∏ –ø–µ—Ä–≤–æ–π —Å–º–µ–Ω–µ –ø–∞—Ä–æ–ª—è –∑–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª–∫–∏ –∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É
                if (isFirstPasswordChange) {
                    setTimeout(() => {
                        toggleChangePasswordModal();
                        toggleMenuModal();
                        location.reload();
                    }, 2000);
                } else {
                    // –ü—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π —Å–º–µ–Ω–µ –ø—Ä–æ—Å—Ç–æ —Å–±—Ä–∞—Å—ã–≤–∞–µ–º —Ñ–æ—Ä–º—É —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã
                    setTimeout(() => {
                        document.getElementById('changePasswordForm').reset();
                        setChangePasswordButtonLoading(false);
                        btn.classList.add('btn-primary');
                        btn.classList.remove('bg-green-600', 'cursor-not-allowed');
                        btnText.textContent = "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å";
                    }, 2000);
                }
            }
        }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ —Å–º–µ–Ω—ã –ø–∞—Ä–æ–ª—è
        document.getElementById('changePasswordBtn').addEventListener('click', function() {
            toggleChangePasswordModal();
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–ª–µ –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ –ø–∞—Ä–æ–ª—è, –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ –º–µ–Ω—è–ª –ø–∞—Ä–æ–ª—å
            const currentPasswordField = document.getElementById('currentPasswordField');
            if ({{ user.userprofile.password_changed|yesno:"true,false" }}) {
                currentPasswordField.classList.remove('hidden');
                currentPasswordField.querySelector('input').required = true;
            } else {
                currentPasswordField.classList.add('hidden');
                currentPasswordField.querySelector('input').required = false;
            }
        });

        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª–∫–∏ –ø–æ –∫–ª–∏–∫—É –≤–Ω–µ –æ–∫–Ω–∞
        document.getElementById('changePasswordModal').addEventListener('click', function(e) {
            if (e.target === this) {
                toggleChangePasswordModal();
            }
        });

        // AJAX —Å–º–µ–Ω–∞ –ø–∞—Ä–æ–ª—è
        document.getElementById('changePasswordForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            const form = e.target;
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É –Ω–∞ –∫–Ω–æ–ø–∫–µ
            setChangePasswordButtonLoading(true);

            const formData = new FormData(form);
            const newPassword = formData.get('new_password');
            const confirmPassword = formData.get('confirm_password');
            const currentPassword = formData.get('current_password');

            // –í–∞–ª–∏–¥–∞—Ü–∏—è
            if (newPassword !== confirmPassword) {
                showChangePasswordButtonError("–ü–∞—Ä–æ–ª–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç");
                return;
            }

            if (newPassword.length < 6) {
                showChangePasswordButtonError("–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–µ –º–µ–Ω–µ–µ 6 —Å–∏–º–≤–æ–ª–æ–≤");
                return;
            }

            const csrfToken = form.querySelector('[name=csrfmiddlewaretoken]').value;

            try {
                const response = await fetch("{% url 'change_password' %}", {
                    method: "POST",
                    headers: {
                        'X-CSRFToken': csrfToken,
                        'X-Requested-With': 'XMLHttpRequest'
                    },
                    body: formData
                });

                const data = await response.json();
                
                if (data.success) {
                    // –£—Å–ø–µ—à–Ω–∞—è —Å–º–µ–Ω–∞ –ø–∞—Ä–æ–ª—è
                    showChangePasswordButtonSuccess(data.message || "–ü–∞—Ä–æ–ª—å –∏–∑–º–µ–Ω–µ–Ω!");
                    
                    // –ü–æ—Å–ª–µ –ø–µ—Ä–≤–æ–π —É—Å–ø–µ—à–Ω–æ–π —Å–º–µ–Ω—ã —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–ª–∞–≥ –≤ false
                    if (isFirstPasswordChange) {
                        isFirstPasswordChange = false;
                    }
                } else {
                    showChangePasswordButtonError(data.error || "–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–º–µ–Ω–µ –ø–∞—Ä–æ–ª—è");
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞:', error);
                showChangePasswordButtonError("–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è");
            }
        });
    </script>

  <script>

  
    // –ü–µ—Ä–µ–¥–∞–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏–∑ Django –≤ JavaScript
    window.categories = [
        {% for cat in categories %}
        {
            id: "{{ cat.id }}",
            name: "{{ cat.name|escapejs }}"
        }{% if not forloop.last %},{% endif %}
        {% endfor %}
    ];

    // –ü–µ—Ä–µ–¥–∞—á–∞ URL –∏–∑ Django –≤ JavaScript
    window.ADD_TRANSACTION_URL = "{% url 'add_transaction' %}";
    window.STATIC_URL = "{% static '' %}";

  

    // –§–ª–∞–≥ –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –ø–æ–∫–∞–∑–∞ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è
    window.isNewUser = {% if is_new_user %}true{% else %}false{% endif %};


    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    document.addEventListener("DOMContentLoaded", function() {


        
        
        // –°–∫—Ä—ã–≤–∞–µ–º –ø—É—Å—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π
        const emptyStateFiltered = document.getElementById('emptyStateFiltered');
        if (emptyStateFiltered) {
            emptyStateFiltered.classList.add('hidden');
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
        if (typeof window.initTransactionFilter === 'function') {

            window.initTransactionFilter();
        } else {
            console.error('–§—É–Ω–∫—Ü–∏—è initTransactionFilter –Ω–µ –Ω–∞–π–¥–µ–Ω–∞');
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤–∫–ª–∞–¥–æ–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
        if (typeof window.updateCategoryTabsHandlers === 'function') {
            window.updateCategoryTabsHandlers();
        }
    });
</script>

    

</body>
</html>