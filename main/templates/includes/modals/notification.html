
{% extends "includes/modals/_base_modal.html" %}
{% load static %}

{% block modal_id %}notificationsModal2{% endblock %}
{% block modal_container_class %}h-[70vh] flex flex-col{% endblock %}

{% block modal_content %}
<!-- Хедер модалки - ФИКСИРОВАННЫЙ -->
<div class="p-4 border-b border-gray-700 flex items-center justify-between flex-shrink-0">
    <h2 class="text-xl font-bold flex items-center">
        Уведомления
    </h2>
    <div class="flex items-center space-x-2">
        <button id="closeNotificationsModal2" class="text-gray-300 hover:text-white px-3 py-1 rounded-lg bg-gray-700 hover:bg-gray-600 transition-colors text-sm font-medium flex items-center">
            Закрыть
        </button>
    </div>
</div>

<!-- Фильтры уведомлений - ФИКСИРОВАННЫЙ -->
<div class="p-3 border-b border-gray-700 flex-shrink-0">
    <div class="flex space-x-1 bg-gray-700 rounded-lg p-1">
        <button class="filter-notification-btn flex-1 py-1.5 px-2 rounded text-xs font-medium transition-all active:scale-95 bg-blue-600 text-white" data-filter="all">
            Все
        </button>
        <button class="filter-notification-btn flex-1 py-1.5 px-2 rounded text-xs font-medium transition-all active:scale-95 bg-gray-700 text-gray-300" data-filter="unread">
            Непрочитанные
        </button>
        {% if user.is_staff %}
        <!-- Кнопка чатов с индикатором -->
        <button class="filter-notification-btn flex-1 py-1.5 px-2 rounded text-xs font-medium transition-all active:scale-95 bg-gray-700 text-gray-300 relative" data-filter="chats">
            Чаты
            <!-- Индикатор новых сообщений в чатах -->
            <span id="chatsTabIndicator" class="absolute -top-1 -right-1 w-2 h-2 bg-red-500 rounded-full hidden"></span>
        </button>
        {% endif %}
    </div>
</div>

<!-- Список уведомлений - SCROLLABLE -->
<div class="flex-1 overflow-y-auto p-2 min-h-0">
    <!-- Основные уведомления -->
    <div id="notificationsContent">
        <div class="space-y-2" id="notificationsList2">
            <!-- Уведомления будут загружаться динамически -->
        </div>

        <!-- Пустое состояние для уведомлений -->
        <div id="emptyNotificationsState2" class="text-center py-8 text-gray-500">
            <div class="w-16 h-16 mx-auto mb-3 rounded-full bg-gray-700 flex items-center justify-center">
                <i class="fas fa-bell-slash text-2xl text-gray-500"></i>
            </div>
            <p class="text-gray-400">Уведомлений пока нет</p>
            <p class="text-sm text-gray-500 mt-1">Здесь будут появляться системные уведомления</p>
        </div>
    </div>

    <!-- Секция чатов для админа -->
    {% if user.is_staff %}
    <div id="adminChatsContent" class="hidden">
        <div class="space-y-2" id="adminChatsList">
            <!-- Список чатов будет здесь -->
        </div>

        <!-- Пустое состояние для чатов -->
        <div id="emptyChatsState" class="text-center py-8 text-gray-500 hidden">
            <div class="w-16 h-16 mx-auto mb-3 rounded-full bg-gray-700 flex items-center justify-center">
                <i class="fas fa-comments text-2xl text-gray-500"></i>
            </div>
            <p class="text-gray-400">Активных чатов нет</p>
            <p class="text-sm text-gray-500 mt-1">Здесь появятся чаты с пользователями</p>
        </div>
    </div>
    {% endif %}
</div>

<!-- Футер модалки - ФИКСИРОВАННЫЙ -->
<div class="p-3 border-t border-gray-700 bg-gray-800/80 flex-shrink-0">
    <div class="flex items-center justify-between text-xs text-gray-400">
        <span id="footerCounter">Всего уведомлений: <span id="notificationsCount2">0</span></span>
        <div class="flex items-center space-x-2">
            {% if user.is_staff %}
            <button onclick="openCreateNotificationModal()" class="w-8 h-8 rounded-full flex items-center justify-center text-blue-400 hover:text-blue-300 hover:bg-blue-400/10 transition-colors">
                <i class="fas fa-plus text-sm"></i>
            </button>
            <button onclick="deleteAllNotifications()" class="w-8 h-8 rounded-full flex items-center justify-center text-red-400 hover:text-red-300 hover:bg-red-400/10 transition-colors">
                <i class="fas fa-trash text-sm"></i>
            </button>
            {% else %}
            <button id="markAllAsReadBtn" class="text-green-400 hover:text-green-300 transition-colors text-xs flex items-center">
                <i class="fas fa-check-double mr-1"></i> Сделать все прочитанными
            </button>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}
